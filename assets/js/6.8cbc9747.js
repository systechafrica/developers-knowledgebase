(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{275:function(e,t,r){e.exports=r.p+"assets/img/Aspose.Words.554d3b2f-b08d-466a-accf-9ecc0048cbb6.002.23985d5c.png"},293:function(e,t,r){"use strict";r.r(t);var o=r(14),n=Object(o.a)({},(function(){var e=this,t=e._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[t("h1",{attrs:{id:"owasp-top-ten-proactive-controls-project"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#owasp-top-ten-proactive-controls-project"}},[e._v("#")]),e._v(" OWASP Top Ten Proactive Controls Project")]),e._v(" "),t("hr"),e._v(" "),t("img",{staticClass:"center",attrs:{alt:"deductionandarrears",width:"90%",height:"auto",src:r(275)}}),e._v(" "),t("p",[t("strong",[e._v("About OWASP")])]),e._v(" "),t("p",[e._v("The "),t("em",[e._v("Open Web Application Security Project")]),e._v(" (OWASP) is a 501c3 non for profit educational charity  dedicated  to  enabling  organizations  to  design,  develop,  acquire,  operate,  and maintain secure software. All OWASP tools, documents, forums, and chapters are free and open  to  anyone  interested  in  improving  application  security.  We  can  be  found  at "),t("a",{attrs:{href:"http://www.owasp.org/",target:"_blank",rel:"noopener noreferrer"}},[e._v("www.owasp.org. "),t("OutboundLink")],1)]),e._v(" "),t("p",[e._v("OWASP is not affiliated with any technology company. Similar to many open source software projects, OWASP produces many types of materials in a collaborative and open way. The OWASP Foundation is a not-for-profit entity that ensures the project's long-term success.")]),e._v(" "),t("p",[t("strong",[e._v("FOREWORD")])]),e._v(" "),t("p",[e._v("Insecure software is undermining our financial, healthcare, defense, energy, and other critical infrastructure worldwide. As our digital, global infrastructure gets increasingly complex and interconnected, the difficulty of achieving application security increases exponentially. We can no longer afford to tolerate relatively simple security problems.")]),e._v(" "),t("p",[t("strong",[e._v("AIM&OBJECTIF")])]),e._v(" "),t("p",[e._v("The goal of the "),t("em",[e._v("OWASP Top 10 Proactive Controls project (OPC)")]),e._v(" is to raise awareness about application  security  by  describing  the  most  important  areas  of  concern  that  software developers must be aware of. We encourage you to use the OWASP Proactive Controls to get your developers started with application security. Developers can learn from the mistakes of other organizations. We hope that the OWASP Proactive Controls is useful to your efforts in building secure software.)")]),e._v(" "),t("p",[t("strong",[e._v("INTRODUCTION")])]),e._v(" "),t("h2",{attrs:{id:"the-owasp-top-ten-proactive-controls-2018-is-a-list-of-security-techniques-that-should-be-considered-for-every-software-development-project-this-document-is-written-for-developers-to-assist-those-new-to-secure-development"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#the-owasp-top-ten-proactive-controls-2018-is-a-list-of-security-techniques-that-should-be-considered-for-every-software-development-project-this-document-is-written-for-developers-to-assist-those-new-to-secure-development"}},[e._v("#")]),e._v(" The OWASP Top Ten Proactive Controls 2018 is a list of security techniques that should be considered for every software development project. This document is written for developers to assist those new to secure development.")]),e._v(" "),t("p",[t("strong",[e._v("The Top 10 Proactive Controls")])]),e._v(" "),t("p",[e._v("The list is ordered by importance with list item number 1 being the most important üòÉ")]),e._v(" "),t("ul",[t("li",[t("p",[e._v("C1:"),t("strong",[e._v("Define Security Requirements")])])]),e._v(" "),t("li",[t("p",[e._v("C2:"),t("strong",[e._v("Leverage Security Frameworks and Libraries")])])]),e._v(" "),t("li",[t("p",[e._v("C3:"),t("strong",[e._v("Secure Database Access")])])]),e._v(" "),t("li",[t("p",[e._v("C4:"),t("strong",[e._v("Encode and Escape Data")])])]),e._v(" "),t("li",[t("p",[e._v("C5:"),t("strong",[e._v("Validate All Inputs")])])]),e._v(" "),t("li",[t("p",[e._v("C6:"),t("strong",[e._v("Implement Digital Identity")])])]),e._v(" "),t("li",[t("p",[e._v("C7:"),t("strong",[e._v("Enforce Access Controls")])])]),e._v(" "),t("li",[t("p",[e._v("C8:"),t("strong",[e._v("Protect Data Everywhere")])])]),e._v(" "),t("li",[t("p",[e._v("C9:"),t("strong",[e._v("Implement Security Logging and Monitoring")])])]),e._v(" "),t("li",[t("p",[e._v("C10:"),t("strong",[e._v("Handle All Errors and Exceptions")])])])]),e._v(" "),t("hr"),e._v(" "),t("p",[t("em",[t("strong",[e._v("C1: Define Security Requirements")])])]),e._v(" "),t("p",[e._v("A security requirement is a statement of needed security functionality that ensures one of many different security properties of software is being satisfied. Security requirements are derived from industry standards, applicable laws, and a history of past vulnerabilities. Security requirements define new features or additions to existing features to solve a specific security problem or eliminate a potential vulnerability.")]),e._v(" "),t("p",[e._v("Security requirements provide a foundation of vetted security functionality for an application. Instead of creating a custom approach to security for every application, standard security requirements allow developers to reuse the definition of security controls and best practices. Those  same  vetted  security  requirements  provide  solutions  for  security  issues  that  have occurred in the past. Requirements exist to prevent the repeat of past security failures.)")]),e._v(" "),t("p",[t("em",[t("strong",[e._v("The OWASP ASVS")])])]),e._v(" "),t("p",[e._v("The "),t("a",{attrs:{href:"https://www.owasp.org/index.php/Category:OWASP_Application_Security_Verification_Standard_Project",target:"_blank",rel:"noopener noreferrer"}},[e._v("OWASP Application Security Verification Standard (ASVS)"),t("OutboundLink")],1),e._v(" is a catalog of available security requirements and verification criteria. OWASP ASVS  can be a source of detailed security requirements for development teams.")]),e._v(" "),t("p",[e._v("Security requirements are categorized into different buckets based on a shared higher order security function. For example, the ASVS contains categories such as authentication, access control, error handling / logging, and web services. Each category contains a collection of requirements  that  represent  the  best  practices  for  that  category  drafted  as  verifiable statements.")]),e._v(" "),t("p",[t("em",[t("strong",[e._v("Augmenting Requirements with User Stories and Misuse Cases")])])]),e._v(" "),t("p",[e._v("The ASVS requirements are basic verifiable statements which can be expanded upon with user stories and misuse cases. The advantage of a user story or misuse case is that it ties the application to exactly what the user or attacker does to the system, versus describing what the system offers to the user.")]),e._v(" "),t("p",[e._v("Here is an example of expanding on an ASVS 3.0.1 requirement. From the ‚ÄúAuthentication Verification  Requirements‚Äù  section  of  ASVS  3.0.1,  requirement  2.19  focuses  on  default passwords.")]),e._v(" "),t("p",[e._v("2.19 Verify there are no default passwords in use for the application framework or any components used by the application such as ‚Äúadmin/password‚Äù")]),e._v(" "),t("p",[e._v("This requirement contains both an action to verify that no default passwords exist, and also carries with it the guidance that no default passwords should be used within the application.")]),e._v(" "),t("p",[e._v("A user story focuses on the perspective of the user, administrator, or attacker of the system, and describes functionality based on what a user wants the system to do for them. A user story takes the form of ‚ÄúAs a user, I can do x, y, and z‚Äù")]),e._v(" "),t("p",[e._v("As a user, I can enter my username and password to gain access to the application.")]),e._v(" "),t("p",[e._v("As a user, I can enter a long password that has a maximum of 1023 characters.")]),e._v(" "),t("p",[e._v("When the story is focused on the attacker and their actions, it is referred to as a misuse case.")]),e._v(" "),t("p",[e._v("As an attacker, I can enter in a default username and password to gain access.")]),e._v(" "),t("p",[e._v("This  story  contains  the  same  message  as  the  traditional  requirement  from  ASVS,  with additional user or attacker details to help make the requirement more testable.")]),e._v(" "),t("p",[t("strong",[e._v("Implementation")])]),e._v(" "),t("p",[e._v("Successful use of security requirements involves four steps. The process includes discovering / selecting, documenting, implementing, and then confirming correct implementation of new security features and functionality within an application.")]),e._v(" "),t("p",[t("em",[t("strong",[e._v("Discovery and Selection")])])]),e._v(" "),t("p",[e._v("The process begins with discovery and selection of security requirements. In this phase, the developer is understanding security requirements from a standard source such as ASVS and choosing which requirements to include for a given release of an application. The point of discovery and selection is to choose a manageable number of security requirements for this release  or  sprint,  and  then  continue  to  iterate  for  each  sprint,  adding  more  security functionality over time.")]),e._v(" "),t("p",[t("em",[t("strong",[e._v("Investigation and Documentation")])])]),e._v(" "),t("p",[e._v("During  investigation  and  documentation,  the  developer  reviews  the  existing  application against the new set of security requirements to determine whether the application currently meets the requirement or if some development is required. This investigation culminates in the documentation of the results of the review.")]),e._v(" "),t("p",[t("em",[t("strong",[e._v("Implementation and Test")])])]),e._v(" "),t("p",[e._v("After  the  need  is  determined  for  development,  the  developer  must  now  modify  the application in some way to add the new functionality or eliminate an insecure option. In this phase the developer first determines the design required to address the requirement, and then completes the code changes to meet the requirement. Test cases should be created to confirm  the  existence  of  the  new  functionality  or  disprove  the existence  of  a  previously insecure option.")]),e._v(" "),t("p",[t("strong",[e._v("Vulnerabilities Prevented")])]),e._v(" "),t("p",[e._v("Security requirements define the security functionality of an application. Better security built in from the beginning of an applications life cycle results in the prevention of many types of vulnerabilities.")]),e._v(" "),t("p",[t("strong",[e._v("References")])]),e._v(" "),t("ul",[t("li",[t("p",[t("a",{attrs:{href:"https://www.owasp.org/index.php/Application_Security_Architecture_Cheat_Sheet",target:"_blank",rel:"noopener noreferrer"}},[e._v("OWASPApplicationSecurityVerificationStandard&ASVS"),t("OutboundLink")],1)])]),e._v(" "),t("li",[t("p",[t("a",{attrs:{href:"https://github.com/OWASP/owasp-masvs",target:"_blank",rel:"noopener noreferrer"}},[e._v("OWASPMobileApplicationSecurityVerificationStandardMASVS"),t("OutboundLink")],1)])]),e._v(" "),t("li",[t("p",[t("a",{attrs:{href:"https://www.owasp.org/index.php/Category:OWASP_Top_Ten_Project",target:"_blank",rel:"noopener noreferrer"}},[e._v("OWASPTopTen"),t("OutboundLink")],1)])])]),e._v(" "),t("hr"),e._v(" "),t("p",[t("em",[t("strong",[e._v("C2: Leverage Security Frameworks and Libraries")])])]),e._v(" "),t("p",[e._v("Secure  coding  libraries  and  software  frameworks  with  embedded  security  help  software developers  guard  against security-related  design  and  implementation  flaws.  A  developer writing an application from scratch might not have sufficient knowledge, time, or budget to properly  implement  or  maintain  security  features.  Leveraging  security  frameworks  helps accomplish security goals more efficiently and accurately.")]),e._v(" "),t("p",[t("em",[t("strong",[e._v("Implementation Best Practices")])])]),e._v(" "),t("p",[e._v("When incorporating third party libraries or frameworks into your software, it is important to consider the following best practices üòÉ")]),e._v(" "),t("ol",[t("li",[t("p",[e._v("Use libraries and frameworks from trusted sources that are actively maintained and widely used by many applications.")])]),e._v(" "),t("li",[t("p",[e._v("Create and maintain an inventory catalog of all the third party libraries.)")])]),e._v(" "),t("li",[t("p",[e._v("Proactively  keep  libraries  and  components  up  to  date.  Use  a  tool  like "),t("a",{attrs:{href:"https://www.owasp.org/index.php/OWASP_Dependency_Check",target:"_blank",rel:"noopener noreferrer"}},[e._v("OWASP Dependency Check"),t("OutboundLink")],1),e._v(" and "),t("a",{attrs:{href:"https://retirejs.github.io/retire.js/",target:"_blank",rel:"noopener noreferrer"}},[e._v("Retire.JS"),t("OutboundLink")],1),e._v(" to identify project dependencies and check if there are any known, publicly disclosed vulnerabilities for all third party code.")])]),e._v(" "),t("li",[t("p",[e._v("Reduce the attack surface by encapsulating the library and expose only the required behaviour into your software.")])])]),e._v(" "),t("p",[t("strong",[e._v("Vulnerabilities Prevented")])]),e._v(" "),t("p",[e._v("Secure  frameworks  and  libraries  can  help  to  prevent  a  wide  range  of  web  application vulnerabilities. It is critical to keep these frameworks and libraries up to date as described in the "),t("a",{attrs:{href:"https://www.owasp.org/index.php/Category:OWASP_Top_Ten_Project",target:"_blank",rel:"noopener noreferrer"}},[e._v("using components with known vulnerabilities Top Ten 2017 risk."),t("OutboundLink")],1)]),e._v(" "),t("p",[t("strong",[e._v("Tools")])]),e._v(" "),t("ul",[t("li",[t("p",[t("a",{attrs:{href:"https://www.owasp.org/index.php/OWASP_Dependency_Check",target:"_blank",rel:"noopener noreferrer"}},[e._v("OWASPDependencyCheck"),t("OutboundLink")],1),e._v("- identifies project dependencies and checks for publicly disclosed vulnerabilities")])]),e._v(" "),t("li",[t("p",[t("a",{attrs:{href:"http://retirejs.github.io/retire.js/",target:"_blank",rel:"noopener noreferrer"}},[e._v("Retire.JS"),t("OutboundLink")],1),e._v(" scanner for JavaScript libraries")])])]),e._v(" "),t("hr"),e._v(" "),t("p",[t("em",[t("strong",[e._v("C3: Secure Database Access")])])]),e._v(" "),t("p",[e._v("This section describes secure access to all data stores, including both relational databases and NoSQL databases. Some areas to consider üòÉ")]),e._v(" "),t("ol",[t("li",[t("p",[e._v("Secure queries")])]),e._v(" "),t("li",[t("p",[e._v("Secure configuration")])]),e._v(" "),t("li",[t("p",[e._v("Secure authentication")])]),e._v(" "),t("li",[t("p",[e._v("Secure communication")])])]),e._v(" "),t("p",[t("strong",[e._v("Secure Queries")])]),e._v(" "),t("p",[e._v("SQL Injection occurs when untrusted user input is dynamically added to a SQL query in an insecure  manner,  often  via  basic  string  concatenation.  SQL  Injection  is  one  of  the  most dangerous application security risks. SQL Injection is easy to exploit and could lead to the entire database being stolen, wiped, or modified. The application can even be used to run dangerous commands against the operating system hosting your database, thereby giving an attacker a foothold on your network.")]),e._v(" "),t("p",[e._v("In  order  to  mitigate  SQL  injection,  untrusted  input  should  be  prevented  from  being interpreted as part of a SQL command. The best way to do this is with the programming technique known as ‚ÄòQuery Parameterization‚Äô. This defense should be applied to SQL, OQL, as well as stored procedure construction.")]),e._v(" "),t("p",[e._v("A good list of query parameterization examples in ASP, ColdFusion, C#, Delphi, .NET, Go, Java, Perl, PHP, PL/SQL, PostgreSQL, Python, R, Ruby and Scheme can  be  found  at")]),e._v(" "),t("ul",[t("li",[t("a",{attrs:{href:"http://bobby-tables.com/",target:"_blank",rel:"noopener noreferrer"}},[e._v("http://bobby-tables.com"),t("OutboundLink")],1),e._v(" and the")]),e._v(" "),t("li",[t("a",{attrs:{href:"https://www.owasp.org/index.php/Query_Parameterization_Cheat_Sheet",target:"_blank",rel:"noopener noreferrer"}},[e._v("OWASPCheatSheetonQuery Parameterization."),t("OutboundLink")],1)])]),e._v(" "),t("p",[t("em",[t("strong",[e._v("Caution on Query Parameterization")])])]),e._v(" "),t("p",[e._v("Certain locations in a database query are not parameterizable. These locations are different for each database vendor. Be certain to do very careful exact-match validation or manual escaping  when  confronting  database  query  parameters  that  cannot  be  bound  to  a parameterized  query.  Also,  while  the  use  of  parameterized  queries  largely  has  a  positive impact on performance, certain parameterized queries in specific database implementations  will  affect  performance  negatively.  Be  sure  to  test  queries  for  performance;  especially complex queries with extensive like clause or text searching capabilities.)")]),e._v(" "),t("p",[t("strong",[e._v("Secure Configuration")])]),e._v(" "),t("p",[e._v("Unfortunately, database management systems do not always ship in a ‚Äúsecure by default‚Äù configuration. Care must be taken to ensure that the security controls available from the Database  Management  System (DBMS) and  hosting  platform  are  enabled  and  properly configured. There are standards, guides, and benchmarks available for most common DBMS.")]),e._v(" "),t("p",[t("strong",[e._v("Secure Authentication")])]),e._v(" "),t("p",[e._v("All access to the database should be properly authenticated. Authentication to the DBMS should be accomplished in a secure manner. Authentication should take place only over a secure channel.  Credentials must be properly secured and available for use.")]),e._v(" "),t("p",[t("strong",[e._v("Secure Communication")])]),e._v(" "),t("p",[e._v("Most  DBMS  support  a  variety  of  communications  methods  &services,  APIs,  etc -  secure authenticated,  encrypted&and  insecure  unauthenticated  or  unencrypted.  It  is  a  good practice to only use the secure communications options per the "),t("em",[e._v("Protect Data Everywhere")]),e._v(" control.")]),e._v(" "),t("p",[t("strong",[e._v("Vulnerabilities Prevented")]),e._v(")")]),e._v(" "),t("ul",[t("li",[t("p",[t("a",{attrs:{href:"https://www.owasp.org/index.php/Top_10-2017_A1-Injection",target:"_blank",rel:"noopener noreferrer"}},[e._v("OWASP Top 10 2017- A1: Injection "),t("OutboundLink")],1)])]),e._v(" "),t("li",[t("p",[t("a",{attrs:{href:"https://www.owasp.org/index.php/Mobile_Top_10_2014-M1",target:"_blank",rel:"noopener noreferrer"}},[e._v("OWASP Mobile Top 10 2014-M1 Weak Server Side Controls"),t("OutboundLink")],1)])])]),e._v(" "),t("p",[t("strong",[e._v("References")])]),e._v(" "),t("ul",[t("li",[t("p",[t("a",{attrs:{href:"https://www.owasp.org/index.php/Query_Parameterization_Cheat_Sheet",target:"_blank",rel:"noopener noreferrer"}},[e._v("OWASP Cheat Sheet: Query Parameterization"),t("OutboundLink")],1)])]),e._v(" "),t("li",[t("p",[t("a",{attrs:{href:"http://bobby-tables.com/",target:"_blank",rel:"noopener noreferrer"}},[e._v("Bobby Tables: A guide to preventing SQL injection"),t("OutboundLink")],1)])]),e._v(" "),t("li",[t("p",[t("a",{attrs:{href:"https://www.cisecurity.org/cis-benchmarks/",target:"_blank",rel:"noopener noreferrer"}},[e._v("CIS Database Hardening Standards"),t("OutboundLink")],1)])])]),e._v(" "),t("hr"),e._v(" "),t("p",[t("strong",[e._v("C4: Encode and Escape Data")])]),e._v(" "),t("p",[e._v("Encoding and escaping are defensive techniques meant to stop injection attacks.")]),e._v(" "),t("ul",[t("li",[e._v('Encoding: commonly  called  "Output  Encoding"  involves  translating  special  characters  into  some different  but  equivalent  form  that  is  no  longer  dangerous  in  the  target  interpreter,  for example translating the ‚Äú<‚Äù character into the &lt; string when writing to an HTML page.')]),e._v(" "),t("li",[e._v('Escaping  involves  adding  a  special  character  before  the  character/string  to  avoid  it  being misinterpreted, for example, adding a ‚Äú\\‚Äù character before a ‚Äú"‚Äù &double quote character so that it is interpreted as text and not as closing a string.')])]),e._v(" "),t("p",[e._v("Output encoding is best applied just before the content is passed to the target interpreter. If this  defense  is  performed  too  early  in  the  processing  of  a  request  then  the  encoding  or escaping  may  interfere  with  the  use  of  the  content  in  other  parts  of  the  program.  For example if you HTML escape content before storing that data in the database and the UI automatically escapes that data a second time then the content will not display properly due to being double escaped.")]),e._v(" "),t("p",[t("strong",[e._v("Contextual Output Encoding")])]),e._v(" "),t("p",[e._v("Contextual output encoding is a crucial security programming technique needed to stop XSS. This  defense  is  performed  on  output,  when  you‚Äôre  building  a  user interface,  at  the  last moment  before  untrusted  data  is  dynamically added  to  HTML.  The  type  of  encoding  will depend on the location or context in the document where data is being displayed or stored. The  different  types  of  encoding  that  would  be  used  for building  secure  user  interfaces includes  HTML  Entity  Encoding,  HTML  Attribute  Encoding,  JavaScript  Encoding,  and  URL Encoding.)")]),e._v(" "),t("p",[t("em",[t("strong",[e._v("Java Encoding Examples")])])]),e._v(" "),t("p",[e._v("For examples of the OWASP Java Encoder providing contextual output encoding see\n"),t("a",{attrs:{href:"https://www.owasp.org/index.php/OWASP_Java_Encoder_Project#tab=Use_the_Java_Encoder_Project",target:"_blank",rel:"noopener noreferrer"}},[e._v("OWASP Java Encoder Project Examples"),t("OutboundLink")],1)]),e._v(" "),t("p",[t("em",[t("strong",[e._v(".NET Encoding Examples")])])]),e._v(" "),t("p",[e._v("Starting with .NET 4.5 , the Anti-Cross Site Scripting library is part of the framework, but not enabled by default. You can specify to use AntiXssEncoder from this library as the default encoder for your entire application using the web.conf settings. When applied is important to contextual  encode  your  output  -  that  means  to  use  the  right  function  from  the AntiXSSEncoder library for the appropriate location of data in document.)")]),e._v(" "),t("p",[t("em",[t("strong",[e._v("PHP Encoding Examples")])]),e._v(" Zend Framework 2")]),e._v(" "),t("p",[e._v("In  Zend  Framework  2 (ZF2),  Zend\\Escaper  can  be  used  for  encoding  the  output.  For contextual encoding examples see\n"),t("a",{attrs:{href:"https://framework.zend.com/blog/2017-05-16-zend-escaper.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("Context-specific escaping with zend-escaper."),t("OutboundLink")],1)]),e._v(" "),t("p",[t("strong",[e._v("Other Types of Encoding and Injection Defense")])]),e._v(" "),t("p",[e._v('Encoding/Escaping can be used to neutralize content against other forms of injection. For example, it\'s possible to neutralize certain special meta-characters when adding input to an operating  system  command.  This  is  called  "OS  command  escaping",  "shell  escaping",  or similar. This defense can be used to stop "Command Injection" vulnerabilities.)')]),e._v(" "),t("p",[e._v("There are other forms of escaping that can be used to stop injection such as XML attribute escaping stopping various forms of XML and XML path injection, as well as LDAP distinguished name escaping that can be used to stop various forms of LDAP injection.")]),e._v(" "),t("p",[t("em",[t("strong",[e._v("Character Encoding and Canonicalization")])])]),e._v(" "),t("p",[e._v("Unicode Encoding is a method for storing characters with multiple bytes. Wherever input data is allowed, data can be entered using\n"),t("a",{attrs:{href:"https://www.owasp.org/index.php/Unicode_Encoding",target:"_blank",rel:"noopener noreferrer"}},[e._v("Unicode"),t("OutboundLink")],1),e._v(" to disguise malicious code and permit a variety of attacks.\n"),t("a",{attrs:{href:"https://tools.ietf.org/html/rfc2279",target:"_blank",rel:"noopener noreferrer"}},[e._v("RFC2279"),t("OutboundLink")],1),e._v(" references many ways that text can be encoded.)")]),e._v(" "),t("p",[e._v("Canonicalization is a method in which systems convert data into a simple or standard form.  Web applications commonly use character canonicalization to ensure all content is of the same character type when stored or displayed.)")]),e._v(" "),t("p",[e._v("To be secure against canonicalization related attacks means an application should be safe when malformed Unicode and other malformed character representations are entered.")]),e._v(" "),t("p",[t("strong",[e._v("Vulnerabilities Prevented")])]),e._v(" "),t("ul",[t("li",[t("p",[t("a",{attrs:{href:"https://www.owasp.org/index.php/Top_10-2017_A1-Injection",target:"_blank",rel:"noopener noreferrer"}},[e._v("OWASP Top 10 2017 - A1: Injection "),t("OutboundLink")],1)])]),e._v(" "),t("li",[t("p",[t("a",{attrs:{href:"https://www.owasp.org/index.php/Top_10-2017_A7-Cross-Site_Scripting_&#40;XSS&#41;",target:"_blank",rel:"noopener noreferrer"}},[e._v("OWASP Top 10 2017 - A7: Cross Site Scripting,XSS "),t("OutboundLink")],1)])]),e._v(" "),t("li",[t("p",[t("a",{attrs:{href:"https://www.owasp.org/index.php/Mobile_Top_10_2014-M7",target:"_blank",rel:"noopener noreferrer"}},[e._v("OWASP Mobile_Top_10_2014-M7 Client Side Injection"),t("OutboundLink")],1)])])]),e._v(" "),t("p",[t("strong",[e._v("References")])]),e._v(" "),t("ul",[t("li",[t("p",[t("a",{attrs:{href:"https://www.owasp.org/index.php/Top_10_2013-A1-Injection",target:"_blank",rel:"noopener noreferrer"}},[e._v("Top Ten"),t("OutboundLink")],1)])]),e._v(" "),t("li",[t("p",[t("a",{attrs:{href:"https://www.owasp.org/index.php/XSS",target:"_blank",rel:"noopener noreferrer"}},[e._v("XSS"),t("OutboundLink")],1)])]),e._v(" "),t("li",[t("p",[t("a",{attrs:{href:"https://www.owasp.org/index.php/XSS_Filter_Evasion_Cheat_Sheet",target:"_blank",rel:"noopener noreferrer"}},[e._v("Generalinformation"),t("OutboundLink")],1)])]),e._v(" "),t("li",[t("p",[t("a",{attrs:{href:"https://www.owasp.org/index.php/XSS_&#40;Cross_Site_Scripting&#41;_Prevention_Cheat_Sheet",target:"_blank",rel:"noopener noreferrer"}},[e._v("OWASP Cheat Sheet: XSS Prevention"),t("OutboundLink")],1)])]),e._v(" "),t("li",[t("p",[t("a",{attrs:{href:"https://www.owasp.org/index.php/XSS_%5CCross_Site_Scripting_Prevention_Cheat_Sheet",target:"_blank",rel:"noopener noreferrer"}},[e._v("Stopping XSS in your web application"),t("OutboundLink")],1)])]),e._v(" "),t("li",[t("p",[t("a",{attrs:{href:"https://www.owasp.org/index.php/DOM_based_XSS_Prevention_Cheat_Sheet",target:"_blank",rel:"noopener noreferrer"}},[e._v("OWASP Cheat Sheet: DOM based XSS Prevention"),t("OutboundLink")],1)])]),e._v(" "),t("li",[t("p",[t("a",{attrs:{href:"https://www.owasp.org/index.php/Injection_Prevention_Cheat_Sheet",target:"_blank",rel:"noopener noreferrer"}},[e._v("OWASP Cheat Sheet: Injection Prevention"),t("OutboundLink")],1)])])]),e._v(" "),t("p",[t("strong",[e._v("Tools")])]),e._v(" "),t("ul",[t("li",[t("p",[t("a",{attrs:{href:"https://www.owasp.org/index.php/OWASP_Java_Encoder_Project",target:"_blank",rel:"noopener noreferrer"}},[e._v("OWASP Java Encoder Project "),t("OutboundLink")],1)])]),e._v(" "),t("li",[t("p",[t("a",{attrs:{href:"https://msdn.microsoft.com/en-us/library/system.web.security.antixss.antixssencoder%5Cv=vs.110.aspx",target:"_blank",rel:"noopener noreferrer"}},[e._v("AntiXSSEncoder "),t("OutboundLink")],1)])]),e._v(" "),t("li",[t("p",[t("a",{attrs:{href:"https://framework.zend.com/blog/2017-05-16-zend-escaper.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("Zend\\Escaper"),t("OutboundLink")],1),e._v("- examples of contextual encoding")])])]),e._v(" "),t("hr"),e._v(" "),t("p",[t("strong",[e._v("C5: Validate All Inputs")])]),e._v(" "),t("p",[e._v("Input validation is a programming technique that ensures only properly formatted data may enter a software system component.")]),e._v(" "),t("p",[t("strong",[e._v("Syntax and Semantic Validity")])]),e._v(" "),t("p",[e._v("An  application  should  check  that  data  is  both "),t("strong",[e._v("syntactically")]),e._v("  and "),t("strong",[e._v("semantically")]),e._v("  valid  in  that order before using it in any way & including displaying it back to the user.")]),e._v(" "),t("ul",[t("li",[t("p",[t("strong",[e._v("Syntax validity")]),e._v(" means that the data is in the form that is expected. For example, an application may allow a user to select a four-digit ‚Äúaccount ID‚Äù to perform some kind of operation. The application should assume the user is entering a SQL injection payload, and should check that the data entered by the user is exactly four digits in length, and consists only of numbers in addition to utilizing proper query parameterization.")])]),e._v(" "),t("li",[t("p",[t("strong",[e._v("Semantic validity")]),e._v(" includes only accepting input that is within an acceptable range for the given application functionality and context. For example, a start date must be before an end date when choosing date ranges.")])])]),e._v(" "),t("p",[t("strong",[e._v("Whitelisting vs Blacklisting")])]),e._v(" "),t("p",[e._v("There are two general approaches to performing input syntax validation, commonly known as blacklisting and whitelisting üòÉ")]),e._v(" "),t("ul",[t("li",[t("p",[t("strong",[e._v("Blacklisting")]),e._v(" or "),t("strong",[e._v("blacklist validation")]),e._v(" attempts to check that given data does not contain ‚Äúknown bad‚Äù content. For example, a web application may block input that contains the exact text <SCRIPT> in order to help prevent XSS. However, this defense could be evaded with a lower case script tag or a script tag of mixed case.")])]),e._v(" "),t("li",[t("p",[t("strong",[e._v("Whitelisting")]),e._v(" or "),t("strong",[e._v("whitelist validation")]),e._v(" attempts to check that a given data matches a set of ‚Äúknown good‚Äù rules. For example a whitelist validation rule for a US state would be a 2-letter code that is only one of the valid US states.)")])])]),e._v(" "),t("p",[e._v("When  building  secure  software,  whitelisting  is  the  recommended  minimal  approach. Blacklisting is prone to error and can be bypassed with various evasion techniques and can be dangerous when depended on by itself. Even though blacklisting can often be evaded it can  often be useful to help detect obvious attacks. So while "),t("strong",[e._v("whitelisting")]),e._v(" helps limit the attack surface by ensuring data is of the right syntactic and semantic validity, "),t("strong",[e._v("blacklisting")]),e._v(" helps detect and potentially stop obvious attacks.")]),e._v(" "),t("p",[t("strong",[e._v("Client side and Server side Validation")])]),e._v(" "),t("p",[e._v("Input  validation  must  always  be  done  on  the  server-side  for  security.  While  client  side validation can be useful for both functional and some security purposes it can often be easily bypassed. This makes server-side validation even more fundamental to security. For example, JavaScript validation may alert the user that a particular field must consist of numbers but the server side application must validate that the submitted data only consists of numbers in the appropriate numerical range for that feature.")]),e._v(" "),t("p",[t("strong",[e._v("Regular Expressions")])]),e._v(" "),t("p",[e._v("Regular expressions offer a way to check whether data matches a specific pattern. Let‚Äôs start with a basic example.")]),e._v(" "),t("p",[e._v("The following regular expression is used to define a whitelist rule to validate usernames.")]),e._v(" "),t("p",[t("strong",[e._v("^[a-z0-9_]{3,16}$")])]),e._v(" "),t("p",[e._v("This regular expression allows only lowercase letters, numbers and the underscore character. The username is also restricted to a length of 3 and 16 characters.")]),e._v(" "),t("p",[t("em",[t("strong",[e._v("Caution: Potential for Denial of Service")])])]),e._v(" "),t("p",[e._v("Care should be exercised when creating regular expressions. Poorly designed expressions may result in potential denial of service conditions, aka "),t("a",{attrs:{href:"https://www.owasp.org/index.php/Regular_expression_Denial_of_Service_-_ReDoS",target:"_blank",rel:"noopener noreferrer"}},[e._v("ReDoS"),t("OutboundLink")],1),e._v(" Various tools can test to verify that regular expressions are not vulnerable to ReDoS.")]),e._v(" "),t("p",[t("em",[t("strong",[e._v("Caution: Complexity")])])]),e._v(" "),t("p",[e._v("Regular expressions are just one way to accomplish validation. Regular expressions can be difficult to maintain or understand for some developers. Other validation alternatives involve writing  validation  methods  programmatically  which  can  be  easier  to  maintain  for  some developers.")]),e._v(" "),t("p",[t("strong",[e._v("Limits of Input Validation")])]),e._v(" "),t("p",[e._v('Input validation does not always make data ‚Äúsafe‚Äù since certain forms of complex input may be "valid" but still dangerous. For example a valid email address may contain a SQL injection attack or a valid URL may contain a Cross Site Scripting attack.  Additional defenses besides input validation should always be applied to data such as query parameterization or escaping.)')]),e._v(" "),t("p",[t("strong",[e._v("Challenges of Validating Serialized Data")])]),e._v(" "),t("p",[e._v("Some  forms  of  input  are  so  complex  that  validation  can  only  minimally  protect  the application. For example, it's dangerous to deserialize untrusted data or data that can be manipulated by an attacker. The only safe architectural pattern is to not accept serialized objects from untrusted sources or to only deserialize in limited capacity for only simple data types. You should avoid processing serialized data formats and use easier to defend formats such as JSON when possible.)")]),e._v(" "),t("p",[e._v("If that is not possible then consider a series of validation defenses when processing serialized data.)")]),e._v(" "),t("ul",[t("li",[t("p",[e._v("Implement integrity checks or encryption of the serialized objects to prevent hostile object creation or data tampering.")])]),e._v(" "),t("li",[t("p",[e._v("Enforce strict type constraints during deserialization before object creation; typically code is expecting a definable set of classes. Bypasses to this technique have been demonstrated.")])]),e._v(" "),t("li",[t("p",[e._v("Isolate code that deserializes, such that it runs in very low privilege environments, such as temporary containers.")])]),e._v(" "),t("li",[t("p",[e._v("Log security deserialization exceptions and failures, such as where the incoming type is not the expected type, or the deserialization throws exceptions.")])]),e._v(" "),t("li",[t("p",[e._v("Restrict or monitor incoming and outgoing network connectivity from containers or servers that deserialize.)")])]),e._v(" "),t("li",[t("p",[e._v("Monitor deserialization, alerting if a user deserializes constantly.")])])]),e._v(" "),t("p",[t("strong",[e._v("Unexpected User Input (Mass Assignment)")])]),e._v(" "),t("p",[e._v("Some  frameworks  support  automatic  binding  of  HTTP  requests  parameters  to  server-side objects used by the application. This auto-binding feature can allow an attacker to update server-side objects that were not meant to be modified. The attacker can possibly modify their access control level or circumvent the intended business logic of the application with this feature.)")]),e._v(" "),t("p",[e._v("This  attack  has  a  number  of  names  including:  mass  assignment,  autobinding  and  object injection.")]),e._v(" "),t("p",[e._v("As a simple example, if the user object has a field privilege which specifies the user's privilege level in the application, a malicious user can look for pages where user data is modified and add privilege=admin to the HTTP parameters sent.  If auto-binding is enabled in an insecure fashion, the server-side object representing the user will be modified accordingly.)")]),e._v(" "),t("p",[e._v("Two approaches can be used to handle this üòÉ")]),e._v(" "),t("ul",[t("li",[t("p",[e._v("Avoid binding input directly and use Data Transfer Objects (DTOs) instead.")])]),e._v(" "),t("li",[t("p",[e._v("Enable auto-binding but set up whitelist rules for each page or feature to define which fields are allowed to be auto-bound.")])])]),e._v(" "),t("p",[e._v("More examples are available in the "),t("a",{attrs:{href:"https://www.owasp.org/index.php/Mass_Assignment_Cheat_Sheet",target:"_blank",rel:"noopener noreferrer"}},[e._v(" OWASP Mass Assignment Cheat Sheet."),t("OutboundLink")],1)]),e._v(" "),t("p",[t("strong",[e._v("Validating and Sanitizing HTML")])]),e._v(" "),t("p",[e._v("Consider an application that needs to accept HTML from users via a WYSIWYG editor that represents content as HTML or features that directly accept HTML in input. In this situation validation or escaping will not help.")]),e._v(" "),t("ul",[t("li",[t("p",[e._v("Regular  expressions  are  not  expressive  enough  to  understand  the  complexity  of HTML5.")])]),e._v(" "),t("li",[t("p",[e._v("Encoding or escaping HTML will not help since it will cause the HTML to not render properly.")])])]),e._v(" "),t("p",[e._v("Therefore, you need a library that can parse and clean HTML formatted text. Please see the "),t("a",{attrs:{href:"https://www.owasp.org/index.php/XSS_(Cross_Site_Scripting)_Prevention_Cheat_Sheet#RULE_.236_-_Sanitize_HTML_Markup_with_a_Library_Designed_for_the_Job",target:"_blank",rel:"noopener noreferrer"}},[e._v("XSS Prevention Cheat Sheet on HTML Sanitization "),t("OutboundLink")],1),e._v(" for more information on HTML Sanitization.")]),e._v(" "),t("p",[t("strong",[e._v("Validation Functionality in Libraries and Frameworks")])]),e._v(" "),t("p",[e._v('All languages and most frameworks provide validation libraries or functions which should be leveraged  to  validate  data.  Validation  libraries typically  cover  common  data  types,  length requirements,  integer  ranges,  "is  null"  checks  and  more.  Many  validation  libraries  and frameworks allow you to define your own regular expression or logic for custom validation in a way that allows the programmer to leverage that functionality throughout your application. Examples of validation functionality include')]),e._v(" "),t("ul",[t("li",[t("a",{attrs:{href:"https://secure.php.net/manual/en/filter.examples.validation.php",target:"_blank",rel:"noopener noreferrer"}},[e._v("PHP\\‚Äôsfilter functions"),t("OutboundLink")],1),e._v(" or")]),e._v(" "),t("li",[e._v("the"),t("a",{attrs:{href:"http://hibernate.org/validator/",target:"_blank",rel:"noopener noreferrer"}},[e._v("Hibernate Validator "),t("OutboundLink")],1),e._v(" for Java.\nExamples of HTML Sanitizers include")]),e._v(" "),t("li",[t("a",{attrs:{href:"http://edgeapi.rubyonrails.org/classes/ActionView/Helpers/SanitizeHelper.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("RubyonRailsSanitizeMethod,"),t("OutboundLink")],1)]),e._v(" "),t("li",[t("a",{attrs:{href:"https://www.owasp.org/index.php/OWASP_Java_HTML_Sanitizer_Project",target:"_blank",rel:"noopener noreferrer"}},[e._v("OWASP Java HTML Sanitizer "),t("OutboundLink")],1),e._v(" or")]),e._v(" "),t("li",[t("a",{attrs:{href:"https://github.com/cure53/DOMPurify",target:"_blank",rel:"noopener noreferrer"}},[e._v("DOMPurify"),t("OutboundLink")],1)])]),e._v(" "),t("p",[t("strong",[e._v("Vulnerabilities Prevented")])]),e._v(" "),t("ul",[t("li",[t("p",[e._v("Input validation reduces the attack surface of applications and can sometimes make attacks more difficult against an application.")])]),e._v(" "),t("li",[t("p",[e._v("Input validation is a technique that provides security to certain forms of data, specific to certain attacks and cannot be reliably applied as a general security rule.")])]),e._v(" "),t("li",[t("p",[e._v("Input validation should not be used as the primary method of preventing")])]),e._v(" "),t("li",[t("p",[t("a",{attrs:{href:"https://www.owasp.org/index.php/XSS_(Cross_Site_Scripting)_Prevention_Cheat_Sheet",target:"_blank",rel:"noopener noreferrer"}},[e._v(" XSS,"),t("OutboundLink")],1)])]),e._v(" "),t("li",[t("p",[t("a",{attrs:{href:"https://www.owasp.org/index.php/SQL_Injection_Prevention_Cheat_Sheet",target:"_blank",rel:"noopener noreferrer"}},[e._v(" SQL Injection "),t("OutboundLink")],1),e._v(" and other attacks.")])])]),e._v(" "),t("p",[t("strong",[e._v("References")])]),e._v(" "),t("ul",[t("li",[t("p",[t("a",{attrs:{href:"https://www.owasp.org/index.php/Input_Validation_Cheat_Sheet",target:"_blank",rel:"noopener noreferrer"}},[e._v("OWASP Cheat Sheet: Input Validation"),t("OutboundLink")],1)])]),e._v(" "),t("li",[t("p",[t("a",{attrs:{href:"https://www.owasp.org/index.php/IOS_Developer_Cheat_Sheet#Security_Decisions_via_Untrusted_Inputs_.28M7.29",target:"_blank",rel:"noopener noreferrer"}},[e._v("OWASP Cheat Sheet: iOS - Security Decisions via Untrusted Inputs"),t("OutboundLink")],1)])]),e._v(" "),t("li",[t("p",[t("a",{attrs:{href:"https://www.owasp.org/index.php/Testing_for_Input_Validation",target:"_blank",rel:"noopener noreferrer"}},[e._v("OWASP Testing Guide: Testing for Input Validation"),t("OutboundLink")],1)])])]),e._v(" "),t("p",[t("strong",[e._v("Tools")])]),e._v(" "),t("ul",[t("li",[t("p",[t("a",{attrs:{href:"https://www.owasp.org/index.php/OWASP_Java_HTML_Sanitizer",target:"_blank",rel:"noopener noreferrer"}},[e._v("OWASP Java HTML Sanitizer Project"),t("OutboundLink")],1)])]),e._v(" "),t("li",[t("p",[t("a",{attrs:{href:"http://beanvalidation.org/",target:"_blank",rel:"noopener noreferrer"}},[e._v("Java JSR-303/JSR-349 Bean Validation "),t("OutboundLink")],1)])]),e._v(" "),t("li",[t("p",[t("a",{attrs:{href:"http://hibernate.org/validator/",target:"_blank",rel:"noopener noreferrer"}},[e._v("Java Hibernate Validator "),t("OutboundLink")],1)])]),e._v(" "),t("li",[t("p",[t("a",{attrs:{href:"http://openjdk.java.net/jeps/290",target:"_blank",rel:"noopener noreferrer"}},[e._v("JEP-290 Filter Incoming Serialization Data"),t("OutboundLink")],1)])]),e._v(" "),t("li",[t("p",[t("a",{attrs:{href:"https://commons.apache.org/proper/commons-validator/",target:"_blank",rel:"noopener noreferrer"}},[e._v("Apache Commons Validator"),t("OutboundLink")],1)])]),e._v(" "),t("li",[t("p",[e._v("PHP‚Äôs"),t("a",{attrs:{href:"https://secure.php.net/manual/en/book.filter.php",target:"_blank",rel:"noopener noreferrer"}},[e._v(" filter functions "),t("OutboundLink")],1)])])]),e._v(" "),t("hr"),e._v(" "),t("p",[t("em",[t("strong",[e._v("C6: Implement Digital Identity")])])]),e._v(" "),t("p",[e._v("Digital Identity is the unique representation of a user (or other subject)as they engage in an online transaction. Authentication is the process of verifying that an individual or entity is who they claim to be. Session management is a process by which a server maintains the state of the users  authentication  so  that  the  user  may  continue  to  use  the  system  without  re- authenticating. The "),t("a",{attrs:{href:"https://pages.nist.gov/800-63-3/sp800-63b.html",target:"_blank",rel:"noopener noreferrer"}},[e._v(" NIST  Special  Publication  800-63B:  Digital  Identity  Guidelines Authentication  and Lifecycle Management "),t("OutboundLink")],1),e._v("provides solid guidance on implementing digital identity, authentication and session management controls.)")]),e._v(" "),t("p",[e._v("Below are some recommendations for secure implementation.")]),e._v(" "),t("p",[t("strong",[e._v("Authentication Levels")])]),e._v(" "),t("p",[e._v("NIST 800-63b describes three levels of a authentication assurance called a authentication assurance level (AAL). AAL level 1 is reserved for lower-risk applications that do not contain PII or other private data. At AAL level 1 only single-factor authentication is required, typically through the use of a password.")]),e._v(" "),t("p",[t("em",[t("strong",[e._v("Level 1 : Passwords")])])]),e._v(" "),t("p",[e._v("Passwords are really really important. We need policy, we need to store them securely, we need to sometimes allow users to reset them.")]),e._v(" "),t("p",[t("em",[t("strong",[e._v("Password Requirements")])])]),e._v(" "),t("p",[e._v("Passwords should comply with the following requirements at the very least üòÉ")]),e._v(" "),t("ul",[t("li",[t("p",[e._v("be  at  least  8  characters  in  length  if  multi-factor  authentication  (MFA)  and  other controls are also used. If MFA is not possible, this should be increased to at least 10 characters")])]),e._v(" "),t("li",[t("p",[e._v("all printing ASCII characters as well as the space character should be acceptable in memorized secrets.")])]),e._v(" "),t("li",[t("p",[e._v("encourage the use of long passwords and passphrases.")])]),e._v(" "),t("li",[t("p",[e._v("remove  complexity  requirements  as  these  have  been  found  to  be  of  limited effectiveness.  Instead,  the  adoption  of  MFA  or  longer  password  lengths  is recommended")])]),e._v(" "),t("li",[t("p",[e._v("ensure  that  passwords  used  are  not  commonly  used  passwords  that  have  been already been leaked in a previous compromise.  You may choose to block the top 1000 or 10000 most common passwords which meet the above length requirements and are  found  in  compromised  password  lists.   The  following  link  contains  the  most commonly  found  passwords:\n"),t("a",{attrs:{href:"https://github.com/danielmiessler/SecLists/tree/master/Passwords",target:"_blank",rel:"noopener noreferrer"}},[e._v("https://github.com/danielmiessler/SecLists/tree/master/Passwords"),t("OutboundLink")],1)])])]),e._v(" "),t("p",[t("em",[t("strong",[e._v("Implement Secure Password Recovery Mechanism")])])]),e._v(" "),t("p",[e._v("It is common for an application to have a mechanism for a user to gain access to their account in the event they forget their password. A good design workflow for a password recovery feature  will  use  multi-factor  authentication  elements.  For  example,  it  may  ask  a  security question - something they know, and then send a generated token to a device - something they own.")]),e._v(" "),t("p",[e._v("Please see the "),t("a",{attrs:{href:"https://www.owasp.org/index.php/Forgot_Password_Cheat_Sheet",target:"_blank",rel:"noopener noreferrer"}},[e._v("Forgot_Password_Cheat_Sheet"),t("OutboundLink")],1),e._v(" and "),t("a",{attrs:{href:"https://www.owasp.org/index.php/Choosing_and_Using_Security_Questions_Cheat_Sheet",target:"_blank",rel:"noopener noreferrer"}},[e._v("Choosing_and_Using_Security_Questions_Cheat_Sheet"),t("OutboundLink")],1),e._v(" for further details.")]),e._v(" "),t("p",[t("em",[t("strong",[e._v("Implement Secure Password Storage")])])]),e._v(" "),t("p",[e._v("In order to provide strong authentication controls, an application must securely store user credentials. Furthermore, cryptographic controls should be in place such that if a credential e.g., a password is compromised, the attacker does not immediately have access to this information.")]),e._v(" "),t("p",[t("strong",[e._v("PHP Example for Password Storage")])]),e._v(" "),t("p",[e._v("Below is an example for secure password hashing in PHP using password_hash() function (available since 5.5.0) which defaults to using the bcrypt algorithm. The example uses a work factor of 15.")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v('<?php\n $cost = 15;\n $password_hash = password_hash("secret_password", PASSWORD_DEFAULT, ["cost" => $cost] );\n?>\n')])])]),t("p",[e._v("Please see the "),t("a",{attrs:{href:"https://www.owasp.org/index.php/Password_Storage_Cheat_Sheet",target:"_blank",rel:"noopener noreferrer"}},[e._v("OWASPPasswordStorageCheatSheet"),t("OutboundLink")],1),e._v(" for further details.")]),e._v(" "),t("p",[t("em",[t("strong",[e._v("Level 2 : Multi-Factor Authentication")])])]),e._v(" "),t("p",[e._v('NIST 800-63b AAL level 2 is reserved for higher-risk applications that contain "self-asserted PII or  other  personal  information  made  available  online."  At  AAL  level  2  multi-factor authentication is required including OTP or other forms of multi-factor implementation.')]),e._v(" "),t("p",[e._v("Multi-factor authentication (MFA) ensures that users are who they claim to be by requiring them to identify themselves with a combination of üòÉ")]),e._v(" "),t("ul",[t("li",[t("p",[e._v("Something you know ‚Äì password or PIN")])]),e._v(" "),t("li",[t("p",[e._v("Something you own ‚Äì token or phone")])]),e._v(" "),t("li",[t("p",[e._v("Something you are ‚Äì biometrics, such as a fingerprint")])])]),e._v(" "),t("p",[e._v("Using  passwords  as  a  sole  factor  provides  weak  security.  Multi-factor  solutions  provide  a more  robust  solution  by  requiring  an  attacker  to  acquire  more  than  one  element  to authenticate with the service..")]),e._v(" "),t("p",[e._v("It is worth noting that biometrics, when employed as a single factor of authentication, are not considered acceptable secrets for digital authentication. They can be obtained online or by taking a picture of someone with a camera phone ( e.g., facial images) with or without their knowledge, lifted from objects someone touches (e.g., latent fingerprints), or captured with high resolution images (e.g., iris patterns). Biometrics must be used only as part of multi- factor  authentication  with  a  physical  authenticator  (something  you  own).  For  example, accessing  a  multi-factor  one-time  password  (OTP) device  that  will  generate  a  one-time password that the user manually enters for the verifier.")]),e._v(" "),t("p",[t("em",[t("strong",[e._v("Level 3 : Cryptographic Based Authentication")])])]),e._v(" "),t("p",[e._v('NIST  800-63b  Authentication  Assurance  Level  3  (AAL3)  is  required  when  the  impact  of compromised systems could lead to personal harm, significant financial loss, harm the public interest or involve civil or criminal violations. AAL3 requires authentication that is "based on proof of possession of a key through a cryptographic protocol." This type of authentication is used to achieve the strongest level of authentication assurance. This is typically done though hardware cryptographic modules.')]),e._v(" "),t("p",[t("strong",[e._v("Session Management")])]),e._v(" "),t("p",[e._v("Once the initial successful user authentication has taken place, an application may choose to track and maintain this authentication state for a limited amount of time. This will allow the user to continue using the application without having to keep re-authentication with each request. Tracking of this user state is called Session Management.")]),e._v(" "),t("p",[t("em",[t("strong",[e._v("Session Generation and Expiration")])])]),e._v(" "),t("p",[e._v("User state is tracked in a session. This session is typically stored on the server for traditional web based session management. A session identifier is then given to the user so the user can identify which server-side session contains the correct user data. The client only needs to maintain this session identifier, which also keeps sensitive server-side session data off of the client.")]),e._v(" "),t("p",[e._v("Here are a few controls to consider when building or implementing session management solutions üòÉ")]),e._v(" "),t("ul",[t("li",[t("p",[e._v("Ensure that the session id is long, unique and random.")])]),e._v(" "),t("li",[t("p",[e._v("The application should generate a new session or at least rotate the session id during authentication and re-authentication.")])]),e._v(" "),t("li",[t("p",[e._v("The application should implement an idle timeout after a period of inactivity and an absolute maximum lifetime for each session, after which users must re-authenticate. The length of the timeouts should be inversely proportional with the value of the data protected.")])])]),e._v(" "),t("p",[e._v("Please  see  the "),t("a",{attrs:{href:"https://www.owasp.org/index.php/Session_Management_Cheat_Sheet",target:"_blank",rel:"noopener noreferrer"}},[e._v("SessionManagementCheatSheet"),t("OutboundLink")],1),e._v(" further  details.  ASVS  Section  3  covers additional session management requirements.)")]),e._v(" "),t("p",[t("em",[t("strong",[e._v("Browser Cookies")])])]),e._v(" "),t("p",[e._v("Browser cookies are a common method for web application to store session identifiers for web  applications  implementing  standard session  management  techniques.  Here  are  some defenses to consider when using browser cookies.")]),e._v(" "),t("ul",[t("li",[t("p",[e._v("When  browser  cookies  are  used  as  the  mechanism  for  tracking  the  session  of  an authenticated user,  these should be accessible to a minimum set of domains and paths and should be tagged to expire at, or soon after, the session‚Äôs validity period.")])]),e._v(" "),t("li",[t("p",[e._v("The ‚Äòsecure‚Äô flag should be set to ensure the transfer is done via secure channel only (TLS).")])]),e._v(" "),t("li",[t("p",[e._v("HttpOnly flag should be set to prevent the cookie from  being accessed via JavaScript.")])]),e._v(" "),t("li",[t("p",[e._v("Adding  "),t("a",{attrs:{href:"https://www.owasp.org/index.php/SameSite",target:"_blank",rel:"noopener noreferrer"}},[e._v("‚Äúsamesite‚Äù"),t("OutboundLink")],1),e._v("  attributes  to  cookies  prevents "),t("a",{attrs:{href:"https://caniuse.com/#search=samesite",target:"_blank",rel:"noopener noreferrer"}},[e._v(" some  modern  browsers "),t("OutboundLink")],1),e._v(" from sending  cookies  with  cross-site  requests  and  provides  protection  against  cross-site request forgery and information leakage attacks.")])])]),e._v(" "),t("p",[t("em",[t("strong",[e._v("Tokens")])])]),e._v(" "),t("p",[e._v('Server-side sessions can be limiting for some forms of authentication. "Stateless services" allow for client side management of session data for performance purposes so they server has less of a burden to store and verify user session. These "stateless" applications generate a short-lived access token which can be used to authenticate a client request without sending the user\'s credentials after the initial authentication.)')]),e._v(" "),t("p",[t("em",[t("strong",[e._v("JWT (JSON Web Tokens)")])])]),e._v(" "),t("p",[e._v("JSON Web Token (JWT) is an open standard "),t("a",{attrs:{href:"https://tools.ietf.org/html/rfc7519",target:"_blank",rel:"noopener noreferrer"}},[e._v("RFC 7519"),t("OutboundLink")],1),e._v(" that defines a compact and self- contained way for securely transmitting information between parties as a JSON object. This information can be verified and trusted because it is digitally signed. A JWT token is created during authentication and is verified by the server (or servers) before any processing.")]),e._v(" "),t("p",[e._v("However, JWT's are often not saved by the server after initial creation. JWT's are typically created  and  then  handed  to  a  client  without  being  saved  by  the  server  in  any  way.  The integrity of the token is maintained through the use of digital signatures so a server can later verify that the JWT is still valid and was not tampered with since its creation.")]),e._v(" "),t("p",[e._v("This approach is both stateless and portable in the way that client and server technologies can be different yet still interact.")]),e._v(" "),t("p",[t("strong",[e._v("Caution")])]),e._v(" "),t("p",[e._v("Digital identity, authentication and session management are very big topics. We're scratching the surface of the topic of Digital Identity here. Ensure that your most capable engineering talent is responsible for maintaining the complexity involved with most Identity solutions.")]),e._v(" "),t("p",[t("strong",[e._v("Vulnerabilities Prevented")])]),e._v(" "),t("ul",[t("li",[t("p",[t("a",{attrs:{href:"https://www.owasp.org/index.php/Top_10-2017_A2-Broken_Authentication",target:"_blank",rel:"noopener noreferrer"}},[e._v("OWASP Top 10 2017 A2- Broken Authentication and Session Management"),t("OutboundLink")],1)])]),e._v(" "),t("li",[t("p",[t("a",{attrs:{href:"https://www.owasp.org/index.php/Mobile_Top_10_2014-M5",target:"_blank",rel:"noopener noreferrer"}},[e._v("OWASP Mobile Top 10 2014-M5- Poor Authorization and Authentication "),t("OutboundLink")],1)])])]),e._v(" "),t("p",[t("strong",[e._v("References")])]),e._v(" "),t("ul",[t("li",[t("p",[t("a",{attrs:{href:"https://www.owasp.org/index.php/Authentication_Cheat_Sheet",target:"_blank",rel:"noopener noreferrer"}},[e._v("OWASP Cheat Sheet: Authentication"),t("OutboundLink")],1)])]),e._v(" "),t("li",[t("p",[t("a",{attrs:{href:"https://www.owasp.org/index.php/Password_Storage_Cheat_Sheet",target:"_blank",rel:"noopener noreferrer"}},[e._v("OWASP Cheat Sheet: Password Storage "),t("OutboundLink")],1)])]),e._v(" "),t("li",[t("p",[t("a",{attrs:{href:"https://www.owasp.org/index.php/Forgot_Password_Cheat_Sheet",target:"_blank",rel:"noopener noreferrer"}},[e._v("OWASP Cheat Sheet: Forgot Passwor"),t("OutboundLink")],1)])]),e._v(" "),t("li",[t("p",[t("a",{attrs:{href:"https://www.owasp.org/index.php/Choosing_and_Using_Security_Questions_Cheat_Sheet",target:"_blank",rel:"noopener noreferrer"}},[e._v("OWASP Cheat Sheet: Choosing and Using Security Questions"),t("OutboundLink")],1)])]),e._v(" "),t("li",[t("p",[t("a",{attrs:{href:"https://www.owasp.org/index.php/Session_Management_Cheat_Sheet",target:"_blank",rel:"noopener noreferrer"}},[e._v("OWASP Cheat Sheet: Session Management"),t("OutboundLink")],1)])]),e._v(" "),t("li",[t("p",[t("a",{attrs:{href:"https://www.owasp.org/index.php/Testing_for_authentication",target:"_blank",rel:"noopener noreferrer"}},[e._v("Testing for "),t("OutboundLink")],1)])]),e._v(" "),t("li",[t("p",[t("a",{attrs:{href:"https://www.owasp.org/index.php/IOS_Developer_Cheat_Sheet",target:"_blank",rel:"noopener noreferrer"}},[e._v("OWASP Cheat Sheet: IOS Developer"),t("OutboundLink")],1)])]),e._v(" "),t("li",[t("p",[t("a",{attrs:{href:"https://www.owasp.org/index.php/Testing_for_authentication",target:"_blank",rel:"noopener noreferrer"}},[e._v("OWASP Testing Guide: Testing for Authentication"),t("OutboundLink")],1)])]),e._v(" "),t("li",[t("p",[t("a",{attrs:{href:"https://pages.nist.gov/800-63-3/sp800-63-3.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("NIST Special Publication 800-63 Revision 3 - Digital Identity Guidelines "),t("OutboundLink")],1)])])]),e._v(" "),t("p",[t("strong",[e._v("Tools")])]),e._v(" "),t("ul",[t("li",[e._v("Daniel Miessler "),t("a",{attrs:{href:"https://github.com/danielmiessler/SecLists/tree/master/Passwords",target:"_blank",rel:"noopener noreferrer"}},[e._v("Most commonly found passwords"),t("OutboundLink")],1)])]),e._v(" "),t("hr"),e._v(" "),t("p",[t("em",[t("strong",[e._v("C7: Enforce Access Controls")])])]),e._v(" "),t("p",[e._v("Access Control or Authorization is the process of granting or denying "),t("em",[e._v("specific requests")]),e._v(" from a user, program, or process. Access control also involves the act of "),t("em",[e._v("granting and revoking those privileges")]),e._v(".")]),e._v(" "),t("p",[e._v("It should be noted that authorization (verifying access to specific features or resources) is not equivalent to authentication (verifying identity)")]),e._v(" "),t("p",[e._v("Access  Control  functionality  often  spans  many  areas  of  software  depending  on  the complexity of the access control system. For example, managing access control metadata or building caching for scalability purposes are often additional components in an access control system that need to be built or managed.")]),e._v(" "),t("p",[e._v("There are several different types of access control design that should be considered.")]),e._v(" "),t("ul",[t("li",[t("p",[e._v("Discretionary Access Control (DAC) is a means of restricting access to objects (e.g., files, data entities) based on the identity and need-to-know of subjects (e.g., users, processes) and/or groups to which the object belongs.")])]),e._v(" "),t("li",[t("p",[e._v("Mandatory Access Control (MAC) is a means of restricting access to system resources based on the sensitivity (as represented by a label) of the information contained in the system resource and the formal authorization (i.e., clearance) of users to access information of such sensitivity.")])]),e._v(" "),t("li",[t("p",[e._v("Role Based Access Control (RBAC) is a model for controlling access to resources where permitted actions on resources are identified with roles rather than with individual subject identities.")])]),e._v(" "),t("li",[t("p",[e._v("Attribute  Based  Access  Control  (ABAC)  will  grant  or  deny  user  requests  based  on arbitrary  attributes  of  the  user  and  arbitrary  attributes  of  the  object,  and environment conditions that may be globally recognized and more relevant to the policies at hand.")])])]),e._v(" "),t("p",[t("strong",[e._v("Access Control Design Principles")])]),e._v(" "),t("p",[e._v('The  following  "positive"  access  control  design  requirements  should  be  considered  at  the initial stages of application development.')]),e._v(" "),t("p",[t("em",[t("strong",[e._v("Design Access Control Thoroughly Up Front")])])]),e._v(" "),t("p",[e._v("Once you have chosen a specific access control design pattern, it is often difficult and time consuming  to  re-engineer  access  control  in  your  application  with  a  new  pattern.  Access Control  is  one  of  the  main  areas  of  application  security  design  that  must  be  thoroughly designed  up  front,  especially  when  addressing  requirements  like  multi-tenancy  and horizontal (data dependent) access control.")]),e._v(" "),t("p",[e._v("Access Control design may start simple but can often grow into a complex and feature-heavy security control. When evaluating access control capability of software frameworks, ensure that your access control functionality will allow for customization for your specific access control feature need.")]),e._v(" "),t("p",[t("em",[t("strong",[e._v("Force All Requests to Go Through Access Control Checks")])])]),e._v(" "),t("p",[e._v("Ensure  that  all  request  go  through  some  kind  of  access  control  verification  layer. Technologies like Java filters or other automatic request processing mechanisms are ideal programming artifacts that will help ensure that all requests go through some kind of access control check.")]),e._v(" "),t("p",[t("em",[t("strong",[e._v("Deny by Default")])])]),e._v(" "),t("p",[e._v("Deny by default is the principle that if a request is not specifically allowed, it is denied. There are many ways that this rule will manifest in application code. Some examples of these are üòÉ")]),e._v(" "),t("ol",[t("li",[t("p",[e._v("Application code may throw an error or exception while processing access control requests. In these cases access control should always be denied.")])]),e._v(" "),t("li",[t("p",[e._v("When an administrator creates a new user or a user registers for a new account, that account should have minimal or no access by default until that access is configured.")])]),e._v(" "),t("li",[t("p",[e._v("When a new feature is added to an application all users should be denied to use that feature until it's properly configured.")])])]),e._v(" "),t("p",[t("em",[t("strong",[e._v("Principle of Least Privilege")])])]),e._v(" "),t("p",[e._v("Ensure that all users, programs, or processes are only given as least or as little necessary access  as  possible.  Be  wary  of  systems  that  do  not  provide  granular  access  control configuration capabilities.")]),e._v(" "),t("p",[t("em",[t("strong",[e._v("Don't Hardcode Roles")])])]),e._v(" "),t("p",[e._v("Many application frameworks default to access control that is role based. It is common to find application code that is filled with checks of this nature.")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v('if (user.hasRole("ADMIN")) || (user.hasRole("MANAGER")) {\n                    deleteAccount();\n    } \n')])])]),t("p",[e._v("Be careful about this type of role-based programming in code. It has the following limitations or dangers.")]),e._v(" "),t("ul",[t("li",[t("p",[e._v("Role  based  programming  of  this  nature  is  fragile.  It  is  easy  to  create  incorrect  or missing role checks in code.")])]),e._v(" "),t("li",[t("p",[e._v("Role based programming does not allow for multi-tenancy. Extreme measures like forking the code or added checks for each customer will be required to allow role based systems to have different rules for different customers.")])]),e._v(" "),t("li",[t("p",[e._v("Role based programming does not allow for data-specific or horizontal access control rules.")])]),e._v(" "),t("li",[t("p",[e._v("Large codebases with many access control checks can be difficult to audit or verify the overall application access control policy.")])])]),e._v(" "),t("p",[e._v("Instead, please consider the following access control programming methodology:")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v('if (user.hasAccess("DELETE_ACCOUNT")) {\n    deleteAccount();\n}\n\n')])])]),t("p",[e._v("Attribute  or  feature-based  access  control  checks  of  this  nature  are  the  starting  point  to building well-designed and feature-rich access control systems. This type of programming also allows for greater access control customization capability over time.")]),e._v(" "),t("p",[t("em",[t("strong",[e._v("Log All Access Control Events")])])]),e._v(" "),t("p",[e._v("All access control failures should be logged as these may be indicative of a malicious user probing the application for vulnerabilities.")]),e._v(" "),t("p",[t("strong",[e._v("Vulnerabilities Prevented")])]),e._v(" "),t("ul",[t("li",[t("p",[t("a",{attrs:{href:"https://www.owasp.org/index.php/Top_10-2017_A5-Broken_Access_Control",target:"_blank",rel:"noopener noreferrer"}},[e._v("OWASP Top 10 2017-A5-Broken Access Control "),t("OutboundLink")],1)])]),e._v(" "),t("li",[t("p",[t("a",{attrs:{href:"https://www.owasp.org/index.php/Mobile_Top_10_2014-M5",target:"_blank",rel:"noopener noreferrer"}},[e._v("OWASP Mobile Top 10 2014-M5 Poor Authorization and Authentication"),t("OutboundLink")],1)])])]),e._v(" "),t("p",[t("strong",[e._v("References")])]),e._v(" "),t("ul",[t("li",[t("p",[t("a",{attrs:{href:"https://cheatsheetseries.owasp.org/cheatsheets/Authorization_Cheat_Sheet.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("OWASP Cheat Sheet: Access Control"),t("OutboundLink")],1)])]),e._v(" "),t("li",[t("p",[t("a",{attrs:{href:"https://www.owasp.org/index.php/IOS_Developer_Cheat_Sheet#Remediations_5",target:"_blank",rel:"noopener noreferrer"}},[e._v("OWASP Cheat Sheet:  iOS Developer - Poor Authorization and Authentication"),t("OutboundLink")],1)])]),e._v(" "),t("li",[t("p",[t("a",{attrs:{href:"https://www.owasp.org/index.php/Testing_for_Authorization",target:"_blank",rel:"noopener noreferrer"}},[e._v("OWASP Testing Guide: Testing for Authoriz"),t("OutboundLink")],1),t("a",{attrs:{href:"https://www.owasp.org/index.php/IOS_Developer_Cheat_Sheet#Remediations_5",target:"_blank",rel:"noopener noreferrer"}},[e._v("ation "),t("OutboundLink")],1)])])]),e._v(" "),t("p",[t("strong",[e._v("Tools")]),e._v(")")]),e._v(" "),t("ul",[t("li",[t("a",{attrs:{href:"https://www.owasp.org/index.php/ZAP",target:"_blank",rel:"noopener noreferrer"}},[e._v("OWASP ZAP"),t("OutboundLink")],1),e._v("with the optional"),t("a",{attrs:{href:"https://github.com/zaproxy/zap-extensions/wiki/HelpAddonsAccessControlConcepts",target:"_blank",rel:"noopener noreferrer"}},[e._v("Access Control Testing "),t("OutboundLink")],1),e._v("add-on.")])]),e._v(" "),t("hr"),e._v(" "),t("p",[t("strong",[e._v("C8: Protect Data Everywhere")])]),e._v(" "),t("p",[e._v("Sensitive data such as passwords, credit card numbers, health records, personal information and business secrets require extra protection, particularly if that data falls under privacy laws (EU's General Data Protection Regulation GDPR), financial data protection rules such as PCI Data Security Standard (PCI DSS) or other regulations.")]),e._v(" "),t("p",[e._v("Attackers can steal data from web and webservice applications in a number of ways. For example, if sensitive information in sent over the internet  without communications security, then an attacker on a shared wireless connection could see and steal another user‚Äôs data. Also, an attacker could use SQL Injection to steal passwords and other credentials from an applications database and expose that information to the public.")]),e._v(" "),t("p",[t("strong",[e._v("Data Classification")])]),e._v(" "),t("p",[e._v("It's critical to classify data in your system and determine which level of sensitivity each piece of data belongs to. Each data category can then be mapped to protection rules necessary for each level of sensitivity. For example, public marketing information that is not sensitive may be categorized as public data which is ok to place on the public website. Credit card numbers may be classified as private user data which may need to be encrypted while stored or in transit.")]),e._v(" "),t("p",[t("strong",[e._v("Encrypting Data in Transit")])]),e._v(" "),t("p",[e._v("When transmitting sensitive data over any network, end-to-end communications security (or encryption-in-transit) of some kind should be considered. TLS is by far the most common and widely supported cryptographic protocol for communications security. It is used by many types of applications (web, webservice, mobile) to communicate over a network in a secure fashion. TLS must be properly configured in a variety of ways in order to properly defend secure communications.")]),e._v(" "),t("p",[e._v("The primary benefit of transport layer security is the protection of web application data from unauthorized  disclosure  and  modification  when  it  is  transmitted  between  clients (web browsers) and the web application server, and between the web application server and back end and other non-browser based enterprise components.")]),e._v(" "),t("p",[t("strong",[e._v("Encrypting Data at Rest")])]),e._v(" "),t("p",[e._v("The first rule of sensitive data management is to avoid storing sensitive data when at all possible. If you must store sensitive data then make sure it's cryptographically protected in some way to avoid unauthorized disclosure and modification.")]),e._v(" "),t("p",[e._v("Cryptography (or crypto) is one of the more advanced topics of information security, and one whose understanding requires the most schooling and experience. It is difficult to get right because there are many approaches to encryption, each with advantages and disadvantages that  need  to  be  thoroughly  understood  by  web  solution  architects  and  developers.  In addition,  serious  cryptography  research  is  typically  based  in  advanced  mathematics  and number theory, providing a serious barrier to entry.")]),e._v(" "),t("p",[e._v("Instead of building cryptographic capability from scratch, it is strongly recommended that peer reviewed and open solutions be used, such as the "),t("a",{attrs:{href:"https://github.com/google/tink",target:"_blank",rel:"noopener noreferrer"}},[e._v("Google Tink"),t("OutboundLink")],1),e._v("project,"),t("a",{attrs:{href:"https://www.libsodium.org/",target:"_blank",rel:"noopener noreferrer"}},[e._v(" Libsodium,"),t("OutboundLink")],1),e._v(" and secure storage capability built into many software frameworks and cloud services.")]),e._v(" "),t("p",[t("em",[t("strong",[e._v("Mobile Application: Secure Local Storage")])])]),e._v(" "),t("p",[e._v("Mobile applications are at particular risk of data leakage because mobile devices are regularly lost or stolen yet contain sensitive data.")]),e._v(" "),t("p",[e._v("As a general rule, only the minimum data required should be stored on the mobile device. But if you must store sensitive data on a mobile device, then sensitive data should be stored within each mobile operating systems specific data storage directory. On Android this will be the Android keystore and on iOS this will be the iOS keychain.")]),e._v(" "),t("p",[t("em",[t("strong",[e._v("Key Lifecycle")])])]),e._v(" "),t("p",[e._v("Secret keys are used in applications number of sensitive functions. For example, secret keys can be used to to sign JWTs, protect credit cards, provide various forms of authentication as well as facilitation other sensitive security features. In managing keys, a number of rules should be followed including üòÉ")]),e._v(" "),t("ul",[t("li",[t("p",[e._v("Ensure that any secret key is protected from unauthorized access")])]),e._v(" "),t("li",[t("p",[e._v("Store keys in a proper secrets vault as described below")])]),e._v(" "),t("li",[t("p",[e._v("Use independent keys when multiple keys are required"),t("a",{attrs:{href:"https://www.owasp.org/index.php/Cryptographic_Storage_Cheat_Sheet#Rule_-_Document_concrete_procedures_for_managing_keys_through_the_lifecycle",target:"_blank",rel:"noopener noreferrer"}},[e._v("Cryptographic_Storage_Cheat_Sheet"),t("OutboundLink")],1)])]),e._v(" "),t("li",[t("p",[e._v("Build support for changing algorithms and keys when needed")])]),e._v(" "),t("li",[t("p",[e._v("Build application features to handle a key rotation")])])]),e._v(" "),t("p",[t("em",[t("strong",[e._v("Application Secrets Management")])])]),e._v(" "),t("p",[e._v('Applications  contain  numerous  "secrets"  that  are  needed  for  security  operations.  These include  certificates,  SQL  connection  passwords,  third  party  service  account  credentials, passwords, SSH keys, encryption keys and more. The unauthorized disclosure or modification of these secrets could lead to complete system compromise. In managing application secrets, consider the following.')]),e._v(" "),t("ul",[t("li",[t("p",[e._v("Don‚Äôt store secrets in code, config files or pass them through environment variables. Use tools like"),t("a",{attrs:{href:"https://github.com/michenriksen/gitrob",target:"_blank",rel:"noopener noreferrer"}},[e._v("GitRob"),t("OutboundLink")],1),e._v(" or "),t("a",{attrs:{href:"https://github.com/dxa4481/truffleHog",target:"_blank",rel:"noopener noreferrer"}},[e._v("TruffleHog"),t("OutboundLink")],1),e._v(" to scan code repos for secrets.")])]),e._v(" "),t("li",[t("p",[e._v("Keep keys and your other application-level secrets in a secrets vault like"),t("a",{attrs:{href:"https://github.com/square/keywhiz",target:"_blank",rel:"noopener noreferrer"}},[e._v("KeyWhiz"),t("OutboundLink")],1),e._v(" or Hashicorp‚Äôs "),t("a",{attrs:{href:"https://www.vaultproject.io/",target:"_blank",rel:"noopener noreferrer"}},[e._v("Vault project"),t("OutboundLink")],1),e._v(" or "),t("a",{attrs:{href:"https://aws.amazon.com/kms/",target:"_blank",rel:"noopener noreferrer"}},[e._v("Amazon KMS"),t("OutboundLink")],1),e._v("to provide secure storage and access to application-level secrets at run-time.")])])]),e._v(" "),t("p",[t("strong",[e._v("Vulnerabilities Prevented")])]),e._v(" "),t("ul",[t("li",[t("p",[t("a",{attrs:{href:"https://www.owasp.org/index.php/Top_10-2017_A3-Sensitive_Data_Exposure",target:"_blank",rel:"noopener noreferrer"}},[e._v("OWASP Top 10 2017 - A3: Sensitive Data Exposure"),t("OutboundLink")],1)])]),e._v(" "),t("li",[t("p",[t("a",{attrs:{href:"https://www.owasp.org/index.php/Mobile_Top_10_2014-M2",target:"_blank",rel:"noopener noreferrer"}},[e._v("OWASP Mobile Top 10 2014-M2 Insecure Data Storage "),t("OutboundLink")],1)])])]),e._v(" "),t("p",[t("strong",[e._v("References")])]),e._v(" "),t("ul",[t("li",[t("p",[t("a",{attrs:{href:"https://www.owasp.org/index.php/Transport_Layer_Protection_Cheat_Sheet",target:"_blank",rel:"noopener noreferrer"}},[e._v("OWASP Cheat Sheet: Transport Layer Protection"),t("OutboundLink")],1)])]),e._v(" "),t("li",[t("p",[t("a",{attrs:{href:"https://www.ssllabs.com/projects/best-practices/index.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("Ivan Ristic: SSL/TLS Deployment Best Practice"),t("OutboundLink")],1),t("a",{attrs:{href:"https://www.owasp.org/index.php/Pinning_Cheat_Sheet",target:"_blank",rel:"noopener noreferrer"}},[e._v("s "),t("OutboundLink")],1)])]),e._v(" "),t("li",[t("p",[t("a",{attrs:{href:"https://www.owasp.org/index.php/HTTP_Strict_Transport_Security_Cheat_Sheet",target:"_blank",rel:"noopener noreferrer"}},[e._v("OWASP Cheat Sheet: HSTS "),t("OutboundLink")],1)])]),e._v(" "),t("li",[t("p",[t("a",{attrs:{href:"https://www.owasp.org/index.php/Cryptographic_Storage_Cheat_Sheet",target:"_blank",rel:"noopener noreferrer"}},[e._v("OWASP Cheat Sheet: Cryptographic Storage"),t("OutboundLink")],1)])]),e._v(" "),t("li",[t("p",[t("a",{attrs:{href:"https://www.owasp.org/index.php/Password_Storage_Cheat_Sheet",target:"_blank",rel:"noopener noreferrer"}},[e._v("OWASP Cheat Sheet: Password Storage"),t("OutboundLink")],1)])]),e._v(" "),t("li",[t("p",[t("a",{attrs:{href:"https://www.owasp.org/index.php/IOS_Developer_Cheat_Sheet#Insecure_Data_Storage_.28M1.29",target:"_blank",rel:"noopener noreferrer"}},[e._v("OWASP Cheat Sheet: IOS Developer - Insecure Data Storage "),t("OutboundLink")],1)])]),e._v(" "),t("li",[t("p",[t("a",{attrs:{href:"https://www.owasp.org/index.php/Testing_for_Weak_SSL/TLS_Ciphers,_Insufficient_Transport_Layer_Protection_(OTG-CRYPST-001)",target:"_blank",rel:"noopener noreferrer"}},[e._v("OWASP Testing Guide: Testing for T"),t("OutboundLink")],1),t("a",{attrs:{href:"https://www.owasp.org/index.php/IOS_Application_Security_Testing_Cheat_Sheet#Insecure_data_storage",target:"_blank",rel:"noopener noreferrer"}},[e._v("LS "),t("OutboundLink")],1)])])]),e._v(" "),t("p",[t("strong",[e._v("Tools")])]),e._v(" "),t("ul",[t("li",[t("p",[t("a",{attrs:{href:"https://github.com/nabla-c0d3/sslyze",target:"_blank",rel:"noopener noreferrer"}},[e._v("SSLyze "),t("OutboundLink")],1),e._v("- SSL configuration scanning library and CLI tool)")])]),e._v(" "),t("li",[t("p",[t("a",{attrs:{href:"https://www.ssllabs.com/ssltest/",target:"_blank",rel:"noopener noreferrer"}},[e._v("SSLLabs"),t("OutboundLink")],1),e._v("- Free service for scanning and checking TLS/SSL configuration)")])]),e._v(" "),t("li",[t("p",[t("a",{attrs:{href:"https://www.owasp.org/index.php/O-Saft",target:"_blank",rel:"noopener noreferrer"}},[e._v("OWASP O-Saft TLS Tool "),t("OutboundLink")],1),e._v("- TLS connection testing tool)")])]),e._v(" "),t("li",[t("p",[t("a",{attrs:{href:"https://github.com/michenriksen/gitrob",target:"_blank",rel:"noopener noreferrer"}},[e._v("GitRob "),t("OutboundLink")],1),e._v("- Command line tool to find sensitive information in publicly available files on GitHub)")])]),e._v(" "),t("li",[t("p",[t("a",{attrs:{href:"https://github.com/dxa4481/truffleHog",target:"_blank",rel:"noopener noreferrer"}},[e._v("TruffleHog"),t("OutboundLink")],1),e._v(" - Searches for secrets accidentally committed)")])]),e._v(" "),t("li",[t("p",[t("a",{attrs:{href:"https://github.com/square/keywhiz",target:"_blank",rel:"noopener noreferrer"}},[e._v("KeyWhiz"),t("OutboundLink")],1),e._v("- Secrets manager")])]),e._v(" "),t("li",[t("p",[t("a",{attrs:{href:"https://www.vaultproject.io/",target:"_blank",rel:"noopener noreferrer"}},[e._v("Hashicorp Vault "),t("OutboundLink")],1),e._v("- Secrets manager")])]),e._v(" "),t("li",[t("p",[t("a",{attrs:{href:"https://aws.amazon.com/kms/",target:"_blank",rel:"noopener noreferrer"}},[e._v("Amazon KMS "),t("OutboundLink")],1),e._v("- Manage keys on Amazon AWS")])])]),e._v(" "),t("hr"),e._v(" "),t("p",[t("strong",[e._v("C9: Implement Security Logging and Monitoring")])]),e._v(" "),t("p",[e._v("Logging  is  a  concept  that  most  developers  already  use  for  debugging  and  diagnostic purposes. Security logging is an equally basic concept: to log security information during the runtime operation of an application. Monitoring is the live review of application and security logs  using  various  forms  of  automation.  The  same  tools  and  patterns  can  be  used  for operations, debugging and security purposes.")]),e._v(" "),t("p",[t("strong",[e._v("Benefits of Security Logging")])]),e._v(" "),t("p",[e._v("Security logging can be used for üòÉ")]),e._v(" "),t("ul",[t("li",[t("p",[e._v("Feeding intrusion detection systems")])]),e._v(" "),t("li",[t("p",[e._v("Forensic analysis and investigations")])]),e._v(" "),t("li",[t("p",[e._v("Satisfying regulatory compliance requirements")])])]),e._v(" "),t("p",[t("strong",[e._v("Security Logging Implementation")])]),e._v(" "),t("p",[e._v("The following is a list of security logging implementation best practices.")]),e._v(" "),t("ul",[t("li",[t("p",[e._v("Follow a common logging format and approach within the system and across systems of  an  organization.  An  example  of  a  common  logging  framework  is  the"),t("a",{attrs:{href:"https://logging.apache.org/",target:"_blank",rel:"noopener noreferrer"}},[e._v("Apache Logging Services "),t("OutboundLink")],1),e._v(" which helps provide logging consistency between Java, PHP, .NET,  and C++ applications.")])]),e._v(" "),t("li",[t("p",[e._v("Do  not  log  too  much  or  too  little.  For  example,  make  sure  to  always  log  the timestamp and identifying information including the source IP and user-id, but be careful not to log private or confidential data.")])]),e._v(" "),t("li",[t("p",[e._v("Pay  close  attention  to  time  syncing  across  nodes  to  ensure  that  timestamps  are consistent.")])])]),e._v(" "),t("p",[t("em",[t("strong",[e._v("Logging for Intrusion Detection and Response")])])]),e._v(" "),t("p",[e._v("Use logging to identify activity that indicates that a user is behaving maliciously.  Potentially malicious activity to log includes üòÉ")]),e._v(" "),t("ul",[t("li",[t("p",[e._v("Submitted data that is outside of an expected numeric range.")])]),e._v(" "),t("li",[t("p",[e._v("Submitted data that involves changes to data that should not be modifiable (select list, checkbox or other limited entry component)")])]),e._v(" "),t("li",[t("p",[e._v("Requests that violate server-side access control rules.")])]),e._v(" "),t("li",[t("p",[e._v("A more comprehensive list of possible detection points is available "),t("a",{attrs:{href:"https://www.owasp.org/index.php/AppSensor_DetectionPoints",target:"_blank",rel:"noopener noreferrer"}},[e._v("here."),t("OutboundLink")],1)])])]),e._v(" "),t("p",[e._v("When your application encounters such activity, your application should at the very least log the activity and mark it as a high severity issue.  Ideally, your application should also respond to a possible identified attack, by for example invalidating the user‚Äôs session and locking the user's account. The response mechanisms allows the software to react in realtime to possible identified attacks.")]),e._v(" "),t("p",[t("strong",[e._v("Secure Logging Design")])]),e._v(" "),t("p",[e._v("Logging solutions must be built and managed in a secure way. Secure Logging design may include the following üòÉ")]),e._v(" "),t("ul",[t("li",[t("p",[e._v("Encode and validate any dangerous characters before logging to prevent"),t("a",{attrs:{href:"https://www.owasp.org/index.php/Log_Injection",target:"_blank",rel:"noopener noreferrer"}},[e._v("log injection"),t("OutboundLink")],1),e._v(" or "),t("a",{attrs:{href:"https://www.owasp.org/index.php/Log_Forging",target:"_blank",rel:"noopener noreferrer"}},[e._v("log forging"),t("OutboundLink")],1),e._v(" attacks.")])]),e._v(" "),t("li",[t("p",[e._v("Do not log sensitive information. For example, do not log password, session ID, credit cards, or social security numbers.")])]),e._v(" "),t("li",[t("p",[e._v("Protect log integrity. An attacker may attempt to tamper with the logs. Therefore, the permission of log files and log changes audit should be considered.")])]),e._v(" "),t("li",[t("p",[e._v("Forward logs from distributed systems to a central, secure logging service. This will sure  log  data  cannot  be  lost  if  one  node  is  compromised.  This  also  allows  for centralized monitoring.")])])]),e._v(" "),t("p",[t("strong",[e._v("References")])]),e._v(" "),t("ul",[t("li",[t("p",[t("a",{attrs:{href:"https://www.owasp.org/index.php/AppSensor_DetectionPoints",target:"_blank",rel:"noopener noreferrer"}},[e._v("OWASP AppSensor Detection Points"),t("OutboundLink")],1),e._v(" - Detection points used to identify a malicious user probing for vulnerabilities or weaknesses in application.")])]),e._v(" "),t("li",[t("p",[t("a",{attrs:{href:"https://www.owasp.org/index.php/Log_Injection",target:"_blank",rel:"noopener noreferrer"}},[e._v("OWASP Log injection "),t("OutboundLink")],1)])]),e._v(" "),t("li",[t("p",[t("a",{attrs:{href:"https://www.owasp.org/index.php/Log_Forging",target:"_blank",rel:"noopener noreferrer"}},[e._v("OWASP Log forging "),t("OutboundLink")],1)])]),e._v(" "),t("li",[t("p",[t("a",{attrs:{href:"https://www.owasp.org/index.php/Logging_Cheat_Sheet",target:"_blank",rel:"noopener noreferrer"}},[e._v("OWASP Cheat Sheet: Logging "),t("OutboundLink")],1),e._v(" How to properly implement logging in an application")])]),e._v(" "),t("li",[t("p",[t("a",{attrs:{href:"https://www.owasp.org/index.php/Error_Handling,_Auditing_and_Logging#Logging",target:"_blank",rel:"noopener noreferrer"}},[e._v("OWASP Development Guide: "),t("OutboundLink")],1),e._v(" "),t("a",{attrs:{href:"https://www.owasp.org/index.php/Error_Handling,_Auditing_and_Logging",target:"_blank",rel:"noopener noreferrer"}},[e._v("Logging "),t("OutboundLink")],1)])]),e._v(" "),t("li",[t("p",[t("a",{attrs:{href:"https://www.owasp.org/index.php/Reviewing_Code_for_Logging_Issues",target:"_blank",rel:"noopener noreferrer"}},[e._v("OWASP Code Review Guide: Reviewing Code for Logging Issues "),t("OutboundLink")],1)])])]),e._v(" "),t("p",[t("strong",[e._v("Tools")])]),e._v(" "),t("ul",[t("li",[t("p",[t("a",{attrs:{href:"https://www.owasp.org/index.php/OWASP_Security_Logging_Project",target:"_blank",rel:"noopener noreferrer"}},[e._v("OWASP Security Logging Project"),t("OutboundLink")],1)])]),e._v(" "),t("li",[t("p",[t("a",{attrs:{href:"https://logging.apache.org/",target:"_blank",rel:"noopener noreferrer"}},[e._v("Apache Logging Services "),t("OutboundLink")],1)])])]),e._v(" "),t("hr"),e._v(" "),t("p",[t("strong",[e._v("C10: Handle all Errors and Exceptions")])]),e._v(" "),t("p",[e._v("Exception  handling  is  a  programming  concept  that  allows  an  application  to  respond  to different error states (like network down, or database connection failed, etc) in various ways. Handling exceptions and errors correctly is critical to making your code reliable and secure.")]),e._v(" "),t("p",[e._v("Error and exception handling occurs in all areas of an application including critical business logic as well as security features and framework code.")]),e._v(" "),t("p",[e._v("Error  handling  is  also  important  from  an  intrusion  detection  perspective.  Certain  attacks against your application may trigger errors which can help detect attacks in progress.")]),e._v(" "),t("p",[t("strong",[e._v("Error Handling Mistakes")])]),e._v(" "),t("p",[e._v("Researchers  at  the  University  of  Toronto  have  found  that  even  small  mistakes  in  error handling  or  forgetting  to  handle  errors  can  lead  to"),t("a",{attrs:{href:"https://www.usenix.org/system/files/conference/osdi14/osdi14-paper-yuan.pdf",target:"_blank",rel:"noopener noreferrer"}},[e._v(" catastrophic  failures  in  distributed systems."),t("OutboundLink")],1)]),e._v(" "),t("p",[e._v("Mistakes in error handling can lead to different kinds of security vulnerabilities.")]),e._v(" "),t("ul",[t("li",[t("p",[e._v('Information  leakage:  Leaking  sensitive  information  in  error  messages  can unintentionally help attackers. For example, an error that returns a stack trace or other  internal  error  details  can  provide  an  attacker  with  information  about  your environment.  Even  small  differences  in  handling  different  error  conditions (e.g., returning "invalid user" or "invalid password" on authentication errors) can provide valuable  clues  to  attackers.  As  described  above,  be  sure  to  log  error  details  for forensics and debugging purposes, but don‚Äôt expose this information, especially to an external client.')])]),e._v(" "),t("li",[t("p",[e._v("TLS bypass:  The"),t("a",{attrs:{href:"https://www.dwheeler.com/essays/apple-goto-fail.html",target:"_blank",rel:"noopener noreferrer"}},[e._v(' Apple goto "fail bug"'),t("OutboundLink")],1),e._v(" was a control-flow error in error handling code that lead to a complete compromise of TLS connections on apple systems.")])]),e._v(" "),t("li",[t("p",[e._v("DOS: A lack of basic error handling can lead to system shutdown. This is usually a fairly easy vulnerability for attackers to exploit. Other error handling problems could lead to increased usage of CPU or disk in ways that could degrade the system.")])])]),e._v(" "),t("p",[t("strong",[e._v("Positive Advice")])]),e._v(" "),t("ul",[t("li",[t("p",[e._v("Manage exceptions in a"),t("a",{attrs:{href:"https://www.owasp.org/index.php/Error_Handling#Centralised_exception_handling_.28Struts_Example.29",target:"_blank",rel:"noopener noreferrer"}},[e._v("centralized manner"),t("OutboundLink")],1),e._v(" to avoid duplicated try/catch blocks in the  code.  Ensure  that  all  unexpected  behavior  is  correctly  handled  inside  the application.")])]),e._v(" "),t("li",[t("p",[e._v("Ensure that error messages displayed to users do not leak critical data, but are still verbose enough to enable the proper user response.")])]),e._v(" "),t("li",[t("p",[e._v("Ensure that exceptions are logged in a way that gives enough information for support, QA, forensics or incident response teams to understand the problem.")])]),e._v(" "),t("li",[t("p",[e._v("Carefully test and verify error handling code.")])])]),e._v(" "),t("p",[t("strong",[e._v("References")])]),e._v(" "),t("ul",[t("li",[t("p",[t("a",{attrs:{href:"https://www.owasp.org/index.php/Error_Handling",target:"_blank",rel:"noopener noreferrer"}},[e._v("OWASP Code Review Guide: Error Handling "),t("OutboundLink")],1)])]),e._v(" "),t("li",[t("p",[t("a",{attrs:{href:"https://www.owasp.org/index.php/Testing_for_Error_Handling",target:"_blank",rel:"noopener noreferrer"}},[e._v("OWASP Testing Guide: Testing for Error Handling "),t("OutboundLink")],1)])]),e._v(" "),t("li",[t("p",[t("a",{attrs:{href:"https://www.owasp.org/index.php/Improper_Error_Handling",target:"_blank",rel:"noopener noreferrer"}},[e._v("OWASP Improper Error Handling"),t("OutboundLink")],1)])]),e._v(" "),t("li",[t("p",[t("a",{attrs:{href:"https://cwe.mitre.org/data/definitions/209.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("CWE 209: Information Exposure Through an Error Message"),t("OutboundLink")],1)])]),e._v(" "),t("li",[t("p",[t("a",{attrs:{href:"https://cwe.mitre.org/data/definitions/391.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("CWE 391: Unchecked Error Condition "),t("OutboundLink")],1)])])]),e._v(" "),t("p",[t("strong",[e._v("Tools")])]),e._v(" "),t("ul",[t("li",[t("p",[t("a",{attrs:{href:"http://errorprone.info/",target:"_blank",rel:"noopener noreferrer"}},[e._v("Error Prone "),t("OutboundLink")],1),e._v("- A static analysis tool from Google to catch common mistakes in error handling for Java developers)")])]),e._v(" "),t("li",[t("p",[e._v("One of the most famous automated tools for finding errors at runtime "),t("a",{attrs:{href:"https://github.com/Netflix/SimianArmy",target:"_blank",rel:"noopener noreferrer"}},[e._v("is Netflix's Chaos  Monkey,"),t("OutboundLink")],1),e._v("  which  intentionally  disables  system  instances  to  ensure  that  the overall service will recover correctly.")])])]),e._v(" "),t("p",[t("strong",[e._v("Final word")])]),e._v(" "),t("p",[e._v("This  document  should  be  seen  as  a  starting  point  rather  than  a  comprehensive  set  of techniques  and  practices.  We  want  to  again  emphasize  that  this document  is  intended  to provide initial awareness around building secure software.")]),e._v(" "),t("p",[e._v("Good next steps to help build an application security program include üòÉ")]),e._v(" "),t("ul",[t("li",[t("p",[e._v("To understand some of the risks in web application security please review the "),t("a",{attrs:{href:"https://www.owasp.org/index.php/Category:OWASP_Top_Ten_Project",target:"_blank",rel:"noopener noreferrer"}},[e._v("OWASP Top Ten "),t("OutboundLink")],1),e._v(" and the"),t("a",{attrs:{href:"https://www.owasp.org/index.php/OWASP_Mobile_Security_Project#tab=Top_10_Mobile_Risks",target:"_blank",rel:"noopener noreferrer"}},[e._v(" OWASP Mobile Top Ten. "),t("OutboundLink")],1)])]),e._v(" "),t("li",[t("p",[e._v("Per  Proactive  Control  #1,  a  secure  development  program  should  include  a "),t("em",[e._v("comprehensive list of security requirements")]),e._v(" based on a standard such as the"),t("a",{attrs:{href:"https://www.owasp.org/index.php/Category:OWASP_Application_Security_Verification_Standard_Project",target:"_blank",rel:"noopener noreferrer"}},[e._v(" OWASP (Web) ASVS "),t("OutboundLink")],1),e._v(" and the "),t("a",{attrs:{href:"https://github.com/OWASP/owasp-masvs",target:"_blank",rel:"noopener noreferrer"}},[e._v(" OWASP (Mobile) MASVS."),t("OutboundLink")],1)])]),e._v(" "),t("li",[t("p",[e._v("To understand the core building blocks of a secure software program from a more macro point of view please review the "),t("a",{attrs:{href:"https://www.owasp.org/index.php/OWASP_SAMM_Project",target:"_blank",rel:"noopener noreferrer"}},[e._v(" OWASP OpenSAMM project."),t("OutboundLink")],1)])])])])}),[],!1,null,null,null);t.default=n.exports}}]);