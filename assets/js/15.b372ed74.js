(window.webpackJsonp=window.webpackJsonp||[]).push([[15],{296:function(t,s,a){"use strict";a.r(s);var n=a(14),e=Object(n.a)({},(function(){var t=this,s=t._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"sending-an-email-with-attachment-in-a-linux-bash"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#sending-an-email-with-attachment-in-a-linux-bash"}},[t._v("#")]),t._v(" Sending an Email with Attachment In a Linux Bash")]),t._v(" "),s("p",[t._v("In this tutorial, we'll learn how to send an email with an optional attachment using both Python and Bash scripts.")]),t._v(" "),s("p",[t._v("This is applicable on Automated backup script to send a notification after sending backup process is complete")]),t._v(" "),s("h2",{attrs:{id:"pre-requisite"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#pre-requisite"}},[t._v("#")]),t._v(" pre-requisite")]),t._v(" "),s("p",[t._v("You must have python 3 Installed and a working SMTP credentials")]),t._v(" "),s("h2",{attrs:{id:"python-script-explanation"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#python-script-explanation"}},[t._v("#")]),t._v(" Python Script Explanation")]),t._v(" "),s("p",[t._v("The Python script utilizes the "),s("code",[t._v("smtplib")]),t._v(" library to send emails via SMTP. Here's a breakdown of the Python script:")]),t._v(" "),s("p",[s("code",[t._v("File Name: send_email.py")])]),t._v(" "),s("div",{staticClass:"language-python extra-class"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" smtplib\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" email"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("mime"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("multipart "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" MIMEMultipart\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" email"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("mime"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("text "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" MIMEText\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" email"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("mime"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("base "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" MIMEBase\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" email "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" encoders\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("send_email_with_attachment")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("recipient"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" subject"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" body"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" attachment_path"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("None")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    sender "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'your_email@example.com'")]),t._v("\n    smtp_server "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'smtp.example.com'")]),t._v("\n    smtp_port "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("587")]),t._v("\n    smtp_username "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'your_smtp_username'")]),t._v("\n    smtp_password "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'your_smtp_password'")]),t._v("\n\n    msg "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" MIMEMultipart"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    msg"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'From'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" sender\n    msg"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'To'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" recipient\n    msg"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Subject'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" subject\n\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Attach body")]),t._v("\n    msg"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("attach"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("MIMEText"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("body"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'plain'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#  Attach file if provided")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" attachment_path"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("with")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("open")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("attachment_path"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'rb'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" attachment"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n            part "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" MIMEBase"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'application'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'octet-stream'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n            part"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("set_payload"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("attachment"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("read"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        encoders"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("encode_base64"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("part"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        part"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("add_header"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Content-Disposition'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string-interpolation"}},[s("span",{pre:!0,attrs:{class:"token string"}},[t._v("f'attachment; filename= ")]),s("span",{pre:!0,attrs:{class:"token interpolation"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("attachment_path"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")])]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'")])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        msg"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("attach"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("part"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("try")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        smtp "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" smtplib"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("SMTP"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("smtp_server"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" smtp_port"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        smtp"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("starttls"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        smtp"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("login"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("smtp_username"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" smtp_password"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        smtp"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("sendmail"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("sender"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" recipient"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" msg"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("as_string"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        smtp"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("quit"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("print")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Email sent successfully to"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" recipient"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("except")]),t._v(" Exception "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" e"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("print")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Failed to send email:"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" e"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Email parameters")]),t._v("\nrecipient "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'smnkimathi@gmail.com'")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#set the recipient email")]),t._v("\nsubject "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Gitlab Migration Backup'")]),t._v("\nbody "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'This Gitlab backup has been successfully completed. Please find attached backup file. This is a test email with test attachment.'")]),t._v("\nattachment_path "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/home/symoh/test.zip'")]),t._v("  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Replace with the path to your document, or leave as None(I.E attachment_path = None )")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Send the email with attachment")]),t._v("\nsend_email_with_attachment"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("recipient"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" subject"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" body"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" attachment_path"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("h2",{attrs:{id:"bash-script-explanation"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#bash-script-explanation"}},[t._v("#")]),t._v(" Bash Script Explanation")]),t._v(" "),s("p",[t._v("The Bash script handles email sending using the python script above")]),t._v(" "),s("p",[s("code",[t._v("File Name: send_email.sh")])]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token shebang important"}},[t._v("#!/bin/bash")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Function to send email using Python script")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token function-name function"}},[t._v("send_email_python")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    python3 send_email.py\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Main")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token function-name function"}},[t._v("main")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Call Python script to send email")]),t._v("\n    send_email_python\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Call main function")]),t._v("\nmain\n")])])]),s("blockquote",[s("p",[t._v("Ensure both scripts (send_email.sh and send_email.py) are in the same directory. The Bash script (send_email.sh) calls the Python script (send_email.py) to send the email. You may need to adjust the file paths if they are in different directories.")]),t._v(" "),s("blockquote",[s("p",[t._v("You can attach this script on your backup script or create a cron job for it")])])])])}),[],!1,null,null,null);s.default=e.exports}}]);