<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Unit Testing Best Practices | Systech Knowledge Base</title>
    <meta name="generator" content="VuePress 1.9.9">
    
    <meta name="description" content="Contains the developers knowledge base">
    <meta name="theme-color" content="#3eaf7c">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    
    <link rel="preload" href="/assets/css/0.styles.7a0ac3fc.css" as="style"><link rel="preload" href="/assets/js/app.01d733ff.js" as="script"><link rel="preload" href="/assets/js/2.51e18b29.js" as="script"><link rel="preload" href="/assets/js/30.e924c7bc.js" as="script"><link rel="prefetch" href="/assets/js/10.6b98b1dc.js"><link rel="prefetch" href="/assets/js/11.478366af.js"><link rel="prefetch" href="/assets/js/12.716738f3.js"><link rel="prefetch" href="/assets/js/13.dad37b79.js"><link rel="prefetch" href="/assets/js/14.0d9207d6.js"><link rel="prefetch" href="/assets/js/15.748f69fa.js"><link rel="prefetch" href="/assets/js/16.55c1e4fd.js"><link rel="prefetch" href="/assets/js/17.06c94d70.js"><link rel="prefetch" href="/assets/js/18.b98c5525.js"><link rel="prefetch" href="/assets/js/19.da16f74d.js"><link rel="prefetch" href="/assets/js/20.4ab5ba82.js"><link rel="prefetch" href="/assets/js/21.d8c952ba.js"><link rel="prefetch" href="/assets/js/22.88a36e8d.js"><link rel="prefetch" href="/assets/js/23.22746895.js"><link rel="prefetch" href="/assets/js/24.aa7a348b.js"><link rel="prefetch" href="/assets/js/25.b922b1c0.js"><link rel="prefetch" href="/assets/js/26.bc7da741.js"><link rel="prefetch" href="/assets/js/27.a51ed0f8.js"><link rel="prefetch" href="/assets/js/28.df2e163a.js"><link rel="prefetch" href="/assets/js/29.6864cc6c.js"><link rel="prefetch" href="/assets/js/3.c63690de.js"><link rel="prefetch" href="/assets/js/4.57767f75.js"><link rel="prefetch" href="/assets/js/5.4dc67b1c.js"><link rel="prefetch" href="/assets/js/6.4f5b8b78.js"><link rel="prefetch" href="/assets/js/7.3bc7bab5.js"><link rel="prefetch" href="/assets/js/8.1fdb41cb.js"><link rel="prefetch" href="/assets/js/9.ddabfbb1.js">
    <link rel="stylesheet" href="/assets/css/0.styles.7a0ac3fc.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="https://systechafrica.com/wp-content/uploads/2021/03/Overlay-logo.png" alt="Systech Knowledge Base" class="logo"> <span class="site-name can-hide">Systech Knowledge Base</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/getting-started/" class="nav-link">
  Getting Started
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Database Setup" class="dropdown-title"><span class="title">Database Setup</span> <span class="arrow down"></span></button> <button type="button" aria-label="Database Setup" class="mobile-dropdown-title"><span class="title">Database Setup</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/database-setup/oracle-guide/" class="nav-link">
  Oracle Database Setup
</a></li><li class="dropdown-item"><!----> <a href="/database-setup/edb-postgres-guide/" class="nav-link">
  EDB Postgres Setup
</a></li><li class="dropdown-item"><!----> <a href="/database-setup/postgres-guide/" class="nav-link">
  Postgres Setup
</a></li><li class="dropdown-item"><!----> <a href="/database-setup/mysql-guide/" class="nav-link">
  Mysql Setup
</a></li><li class="dropdown-item"><!----> <a href="/database-setup/triggers/" class="nav-link">
  Track Database Changes
</a></li><li class="dropdown-item"><!----> <a href="/database-setup/warehouse-readme/" class="nav-link">
  Warehouse Database
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="DevSecOps" class="dropdown-title"><span class="title">DevSecOps</span> <span class="arrow down"></span></button> <button type="button" aria-label="DevSecOps" class="mobile-dropdown-title"><span class="title">DevSecOps</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/security/" class="nav-link">
  Introduction
</a></li><li class="dropdown-item"><!----> <a href="/security/proactive-control/" class="nav-link">
  Proactive Controls
</a></li><li class="dropdown-item"><!----> <a href="/security/ssl-reverse-proxy/" class="nav-link">
  SSL Installation Using Reverse Proxy
</a></li><li class="dropdown-item"><!----> <a href="/security/ssl-letsencrypt/" class="nav-link">
  SSl Installation using self signed certificate from letsencrypt, apache and reverse proxy
</a></li></ul></div></div><div class="nav-item"><a href="/pension-domain/" class="nav-link">
  Pension Domain
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Fundmaster Guide" class="dropdown-title"><span class="title">Fundmaster Guide</span> <span class="arrow down"></span></button> <button type="button" aria-label="Fundmaster Guide" class="mobile-dropdown-title"><span class="title">Fundmaster Guide</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://documentation.systechafrica.com/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Documentation
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://knowledgebase.systechafrica.com/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Knowledge Base
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/getting-started/" class="nav-link">
  Getting Started
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Database Setup" class="dropdown-title"><span class="title">Database Setup</span> <span class="arrow down"></span></button> <button type="button" aria-label="Database Setup" class="mobile-dropdown-title"><span class="title">Database Setup</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/database-setup/oracle-guide/" class="nav-link">
  Oracle Database Setup
</a></li><li class="dropdown-item"><!----> <a href="/database-setup/edb-postgres-guide/" class="nav-link">
  EDB Postgres Setup
</a></li><li class="dropdown-item"><!----> <a href="/database-setup/postgres-guide/" class="nav-link">
  Postgres Setup
</a></li><li class="dropdown-item"><!----> <a href="/database-setup/mysql-guide/" class="nav-link">
  Mysql Setup
</a></li><li class="dropdown-item"><!----> <a href="/database-setup/triggers/" class="nav-link">
  Track Database Changes
</a></li><li class="dropdown-item"><!----> <a href="/database-setup/warehouse-readme/" class="nav-link">
  Warehouse Database
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="DevSecOps" class="dropdown-title"><span class="title">DevSecOps</span> <span class="arrow down"></span></button> <button type="button" aria-label="DevSecOps" class="mobile-dropdown-title"><span class="title">DevSecOps</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/security/" class="nav-link">
  Introduction
</a></li><li class="dropdown-item"><!----> <a href="/security/proactive-control/" class="nav-link">
  Proactive Controls
</a></li><li class="dropdown-item"><!----> <a href="/security/ssl-reverse-proxy/" class="nav-link">
  SSL Installation Using Reverse Proxy
</a></li><li class="dropdown-item"><!----> <a href="/security/ssl-letsencrypt/" class="nav-link">
  SSl Installation using self signed certificate from letsencrypt, apache and reverse proxy
</a></li></ul></div></div><div class="nav-item"><a href="/pension-domain/" class="nav-link">
  Pension Domain
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Fundmaster Guide" class="dropdown-title"><span class="title">Fundmaster Guide</span> <span class="arrow down"></span></button> <button type="button" aria-label="Fundmaster Guide" class="mobile-dropdown-title"><span class="title">Fundmaster Guide</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://documentation.systechafrica.com/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Documentation
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://knowledgebase.systechafrica.com/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Knowledge Base
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Getting Started</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Database Setup</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Backups Guide</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>Testing</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/testing/unit-testing.html" aria-current="page" class="active sidebar-link">Unit Testing Best Practices</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/testing/unit-testing.html#introduction" class="sidebar-link">Introduction</a></li><li class="sidebar-sub-header"><a href="/testing/unit-testing.html#_1-method-mocking-and-verification" class="sidebar-link">1. Method Mocking and verification</a></li><li class="sidebar-sub-header"><a href="/testing/unit-testing.html#_2-difference-between-injectmock-mock-and-spy" class="sidebar-link">2. Difference between @InjectMock, @Mock, and @Spy</a></li><li class="sidebar-sub-header"><a href="/testing/unit-testing.html#_3-avoid-method-chaining" class="sidebar-link">3. Avoid Method Chaining</a></li><li class="sidebar-sub-header"><a href="/testing/unit-testing.html#_4-avoid-injectmock-on-interface" class="sidebar-link">4. Avoid InjectMock on Interface</a></li><li class="sidebar-sub-header"><a href="/testing/unit-testing.html#_5-memberdaoimpltest" class="sidebar-link">5. MemberDaoImplTest</a></li><li class="sidebar-sub-header"><a href="/testing/unit-testing.html#_6-mocking-void-methods" class="sidebar-link">6. Mocking Void Methods</a></li><li class="sidebar-sub-header"><a href="/testing/unit-testing.html#_7-handling-numbers" class="sidebar-link">7. Handling Numbers</a></li><li class="sidebar-sub-header"><a href="/testing/unit-testing.html#_8-mock-interfaces-not-classes" class="sidebar-link">8. Mock Interfaces, Not Classes</a></li><li class="sidebar-sub-header"><a href="/testing/unit-testing.html#_9-mock-part-of-object" class="sidebar-link">9. Mock Part of Object</a></li><li class="sidebar-sub-header"><a href="/testing/unit-testing.html#_10-handling-unexpected-exceptions" class="sidebar-link">10. Handling Unexpected Exceptions</a></li><li class="sidebar-sub-header"><a href="/testing/unit-testing.html#_11-use-of-beforeeach-and-aftereach-on-repetitive-method-calls" class="sidebar-link">11. Use of BeforeEach  and AfterEach on repetitive method calls</a></li><li class="sidebar-sub-header"><a href="/testing/unit-testing.html#_12-avoid-dependency-injection-in-test-classes" class="sidebar-link">12. Avoid Dependency Injection in Test Classes</a></li><li class="sidebar-sub-header"><a href="/testing/unit-testing.html#conclusion" class="sidebar-link">Conclusion</a></li></ul></li><li><a href="/testing/integration-testing.html" class="sidebar-link">Integration Testing</a></li><li><a href="/testing/automation-testing.html" class="sidebar-link">Automation Testing</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>DevSecOps</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Pension Domain</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="unit-testing-best-practices"><a href="#unit-testing-best-practices" class="header-anchor">#</a> Unit Testing Best Practices</h1> <h2 id="introduction"><a href="#introduction" class="header-anchor">#</a> Introduction</h2> <p>In this tutorial, we'll cover important practices and techniques for writing effective unit tests in Java, particularly in the context of Enterprise JavaBeans (EJB) and Mockito framework. We'll discuss topics ranging from testing EJBs to mocking dependencies and handling different scenarios.</p> <h2 id="_1-method-mocking-and-verification"><a href="#_1-method-mocking-and-verification" class="header-anchor">#</a> 1. Method Mocking and verification</h2> <blockquote><p>Method mocking refers to the process of replacing a real method with a mock implementation during testing. This allows you to control the behavior of dependencies and isolate the unit under test.</p> <blockquote><p>For Example to test a bean class method that depends on results from dao class method, You can mock the dao methods</p></blockquote></blockquote> <blockquote><p>Method verification is the process of asserting that certain methods were called on a mock object during testing. This allows you to ensure that the unit under test interacts with its dependencies as expected.</p> <blockquote><p>Verify called methods, e.g., audit trail and number of times it was called</p></blockquote></blockquote> <ul><li>Can be applied to methods in dao classes so bean classes can use that data.</li></ul> <div class="language-java extra-class"><pre class="language-java"><code>    <span class="token annotation punctuation">@Test</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">saveInterestRate</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
        <span class="token comment">// Mock dependencies</span>
        <span class="token class-name">Scheme</span> defaultScheme <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Scheme</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        defaultScheme<span class="token punctuation">.</span><span class="token function">setSchemePreferences</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">SchemePreferences</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        defaultScheme<span class="token punctuation">.</span><span class="token function">getSchemePreferences</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setUseToDateYearContrRate</span><span class="token punctuation">(</span><span class="token class-name">YesNo</span><span class="token punctuation">.</span><span class="token constant">YES</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">InterestRate</span> rate <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">InterestRate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">String</span> profileId <span class="token operator">=</span> <span class="token string">&quot;1&quot;</span><span class="token punctuation">;</span>
        <span class="token class-name">User</span> user <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">User</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// Set up expectations</span>
        <span class="token class-name">Date</span> fromDate <span class="token operator">=</span> <span class="token class-name">LocalDate</span><span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toDate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">AccountingPeriod</span> ratePeriod <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">AccountingPeriod</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        ratePeriod<span class="token punctuation">.</span><span class="token function">setId</span><span class="token punctuation">(</span><span class="token number">1L</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        ratePeriod<span class="token punctuation">.</span><span class="token function">setName</span><span class="token punctuation">(</span><span class="token string">&quot;Period 1&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        ratePeriod<span class="token punctuation">.</span><span class="token function">setFromDate</span><span class="token punctuation">(</span>fromDate<span class="token punctuation">)</span><span class="token punctuation">;</span>
        ratePeriod<span class="token punctuation">.</span><span class="token function">setToDate</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">Sponsor</span> sponsor <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Sponsor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        sponsor<span class="token punctuation">.</span><span class="token function">setId</span><span class="token punctuation">(</span><span class="token number">1L</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        sponsor<span class="token punctuation">.</span><span class="token function">setName</span><span class="token punctuation">(</span><span class="token string">&quot;Sponsor 1&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token function">when</span><span class="token punctuation">(</span>sponsorBeanI<span class="token punctuation">.</span><span class="token function">findById</span><span class="token punctuation">(</span>rate<span class="token punctuation">.</span><span class="token function">getSponsorId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">thenReturn</span><span class="token punctuation">(</span>sponsor<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">when</span><span class="token punctuation">(</span>accountingPeriodBean<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span>rate<span class="token punctuation">.</span><span class="token function">getApId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">thenReturn</span><span class="token punctuation">(</span>ratePeriod<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">when</span><span class="token punctuation">(</span>interestRateDAO<span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span><span class="token function">any</span><span class="token punctuation">(</span><span class="token class-name">InterestRate</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">thenReturn</span><span class="token punctuation">(</span>rate<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Mock save method</span>

        <span class="token comment">// Invoke the method</span>
        <span class="token class-name">InterestRate</span> result <span class="token operator">=</span> interestRateEJB<span class="token punctuation">.</span><span class="token function">saveInterestRate</span><span class="token punctuation">(</span>defaultScheme<span class="token punctuation">,</span> rate<span class="token punctuation">,</span> profileId<span class="token punctuation">,</span> user<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// Verify the result</span>
        <span class="token function">assertNotNull</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">assertEquals</span><span class="token punctuation">(</span><span class="token class-name">LocalDate</span><span class="token punctuation">.</span><span class="token function">fromDateFields</span><span class="token punctuation">(</span>fromDate<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getYear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> result<span class="token punctuation">.</span><span class="token function">getYear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// Verify interactions</span>
        <span class="token function">verify</span><span class="token punctuation">(</span>interestRateDAO<span class="token punctuation">,</span> <span class="token function">times</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span><span class="token function">any</span><span class="token punctuation">(</span><span class="token class-name">InterestRate</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">verify</span><span class="token punctuation">(</span>activityTrackerBean<span class="token punctuation">,</span> <span class="token function">times</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">trackActivity</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">InterestRate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toJson</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> result<span class="token punctuation">.</span><span class="token function">toJson</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> user<span class="token punctuation">,</span> <span class="token class-name">AppModules</span><span class="token punctuation">.</span><span class="token constant">ACCOUNTS</span><span class="token punctuation">,</span> <span class="token class-name">CrudOperationType</span><span class="token punctuation">.</span><span class="token constant">CREATE</span><span class="token punctuation">,</span> result<span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                <span class="token string">&quot;CREATED NEW INTEREST RATES FOR ACCOUNTING PERIOD &quot;</span> <span class="token operator">+</span> ratePeriod<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token punctuation">}</span>
</code></pre></div><h2 id="_2-difference-between-injectmock-mock-and-spy"><a href="#_2-difference-between-injectmock-mock-and-spy" class="header-anchor">#</a> 2. Difference between <code>@InjectMock</code>, <code>@Mock</code>, and <code>@Spy</code></h2> <ul><li><code>@InjectMock</code>: Injects mocks into tested objects. This is used on classes</li> <li><code>@Mock</code>: Creates mocks. This is used on interface</li> <li><code>@Spy</code>: Wraps real objects allowing partial mocking.</li> <li>Use <code>@InjectMock</code> for objects under test, <code>@Mock</code> for dependencies, and <code>@Spy</code> for partial mocking. Partial mocking means creating an instance of the object. This is applicable in testing the real execution of a method.</li></ul> <div class="language-java extra-class"><pre class="language-java"><code>    <span class="token annotation punctuation">@Mock</span>
    <span class="token keyword">private</span> <span class="token class-name">CommonStuffBeanI</span> commonStuffBean<span class="token punctuation">;</span>

    <span class="token keyword">private</span> <span class="token class-name">CalculateBenefitsBean</span> calculateBenefitsBean<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@BeforeEach</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setup</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">MockitoAnnotations</span><span class="token punctuation">.</span><span class="token function">openMocks</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        calculateBenefitsBean <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">CalculateBenefitsBean</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        calculateBenefitsBean<span class="token punctuation">.</span><span class="token function">setCommonStuffBean</span><span class="token punctuation">(</span>commonStuffBean<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre></div><p>can be replaced by</p> <div class="language-java extra-class"><pre class="language-java"><code>    <span class="token annotation punctuation">@Mock</span>
    <span class="token keyword">private</span> <span class="token class-name">CommonStuffBeanI</span> commonStuffBean<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Spy</span>
    <span class="token keyword">private</span> <span class="token class-name">CalculateBenefitsBean</span> calculateBenefitsBean<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@BeforeEach</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setup</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">MockitoAnnotations</span><span class="token punctuation">.</span><span class="token function">openMocks</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        calculateBenefitsBean<span class="token punctuation">.</span><span class="token function">setCommonStuffBean</span><span class="token punctuation">(</span>commonStuffBean<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre></div><h2 id="_3-avoid-method-chaining"><a href="#_3-avoid-method-chaining" class="header-anchor">#</a> 3. Avoid Method Chaining</h2> <ul><li>Avoid chaining methods in Mockito stubbing to avoid mockito exceptions</li></ul> <div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">// Avoid this</span>
<span class="token function">when</span><span class="token punctuation">(</span>mock<span class="token punctuation">.</span><span class="token function">method1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">method2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">thenReturn</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Prefer this</span>
<span class="token function">when</span><span class="token punctuation">(</span>mock<span class="token punctuation">.</span><span class="token function">method1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">thenReturn</span><span class="token punctuation">(</span>someValue<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">when</span><span class="token punctuation">(</span>mock<span class="token punctuation">.</span><span class="token function">method2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">thenReturn</span><span class="token punctuation">(</span>otherValue<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>TO resolve this, mock the methods separately</p> <h2 id="_4-avoid-injectmock-on-interface"><a href="#_4-avoid-injectmock-on-interface" class="header-anchor">#</a> 4. Avoid InjectMock on Interface</h2> <ul><li>Use <code>@Mock</code> and initialize mocks in <code>@BeforeEach</code> setup method to initialize all the mocks.</li></ul> <div class="language-java extra-class"><pre class="language-java"><code>    <span class="token annotation punctuation">@BeforeEach</span>
    <span class="token keyword">void</span> <span class="token function">setUp</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">MockitoAnnotations</span><span class="token punctuation">.</span><span class="token function">openMocks</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre></div><h2 id="_5-memberdaoimpltest"><a href="#_5-memberdaoimpltest" class="header-anchor">#</a> 5. MemberDaoImplTest</h2> <ul><li>How to test DAO classes effectively.</li></ul> <div class="language-java extra-class"><pre class="language-java"><code>    <span class="token annotation punctuation">@Mock</span>
    <span class="token keyword">private</span> <span class="token class-name">EntityManager</span> em<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Mock</span>
    <span class="token keyword">private</span> <span class="token class-name">Query</span> query<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Mock</span>
    <span class="token keyword">private</span> <span class="token class-name">MemberBeanI</span> memberBean<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@BeforeEach</span>
    <span class="token keyword">void</span> <span class="token function">setUp</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">MockitoAnnotations</span><span class="token punctuation">.</span><span class="token function">openMocks</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Test</span>
    <span class="token keyword">void</span> <span class="token function">findActiveMemberById</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">Long</span> memberId <span class="token operator">=</span> <span class="token number">1L</span><span class="token punctuation">;</span>

        <span class="token class-name">Member</span> mockMember <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Member</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        mockMember<span class="token punctuation">.</span><span class="token function">setId</span><span class="token punctuation">(</span>memberId<span class="token punctuation">)</span><span class="token punctuation">;</span>
        mockMember<span class="token punctuation">.</span><span class="token function">setMbshipStatus</span><span class="token punctuation">(</span><span class="token class-name">MembershipStatus</span><span class="token punctuation">.</span><span class="token constant">ACTIVE</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Use MembershipStatus.ACTIVE directly</span>

        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Member</span><span class="token punctuation">&gt;</span></span> mockResultList <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        mockResultList<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>mockMember<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// Mock the EntityManager's behavior</span>
        <span class="token function">when</span><span class="token punctuation">(</span>em<span class="token punctuation">.</span><span class="token function">createNativeQuery</span><span class="token punctuation">(</span><span class="token function">anyString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">eq</span><span class="token punctuation">(</span><span class="token class-name">Member</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">thenReturn</span><span class="token punctuation">(</span>query<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Mocking createNativeQuery to return the query mock object</span>

        <span class="token function">when</span><span class="token punctuation">(</span>query<span class="token punctuation">.</span><span class="token function">setParameter</span><span class="token punctuation">(</span><span class="token function">anyString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">anyLong</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">thenReturn</span><span class="token punctuation">(</span>query<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Mocking setParameter method of the query object</span>

        <span class="token function">when</span><span class="token punctuation">(</span>query<span class="token punctuation">.</span><span class="token function">getResultList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">thenReturn</span><span class="token punctuation">(</span>mockResultList<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Mocking getResultList method of the query object to return mockResultList</span>

        <span class="token comment">// Mock the memberBean to return mockMember when findActiveMemberById is called</span>
        <span class="token function">when</span><span class="token punctuation">(</span>memberBean<span class="token punctuation">.</span><span class="token function">findActiveMemberById</span><span class="token punctuation">(</span>memberId<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">thenReturn</span><span class="token punctuation">(</span>mockMember<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// Call the method under test</span>
        <span class="token class-name">Member</span> result <span class="token operator">=</span> memberBean<span class="token punctuation">.</span><span class="token function">findActiveMemberById</span><span class="token punctuation">(</span>memberId<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// Verify the result</span>
        <span class="token function">assertNotNull</span><span class="token punctuation">(</span>result<span class="token punctuation">,</span> <span class="token string">&quot;Result should not be null&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">assertEquals</span><span class="token punctuation">(</span>mockMember<span class="token punctuation">,</span> result<span class="token punctuation">,</span> <span class="token string">&quot;Result should match mock member object&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre></div><ul><li>The method starts by mocking the behavior of the EntityManager (em) using Mockito. It mocks the createNativeQuery() method to return a mock Query object.</li> <li>Next, it mocks the behavior of the Query object (query). It sets up the setParameter() method to return the same query object when invoked with any parameters. It also configures the getResultList() method to return a list containing a mock member object.</li> <li>The method then mocks the behavior of the memberBean object. It sets up the findActiveMemberById() method to return a mock member object when called with a specific member ID (memberId).</li> <li>After setting up the mocks, it invokes the findActiveMemberById() method with the memberId.</li> <li>Finally, it verifies that the returned member object is not null and matches the expected mock member object.</li></ul> <h2 id="_6-mocking-void-methods"><a href="#_6-mocking-void-methods" class="header-anchor">#</a> 6. Mocking Void Methods</h2> <ul><li>You can check for exceptions for void method or verify if child methods were called correctly i.e</li></ul> <ol><li>You can check if the correct exception message is thrown</li></ol> <div class="language-java extra-class"><pre class="language-java"><code>
        <span class="token comment">// Mock void method and throw an exception</span>
        <span class="token function">doThrow</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">RuntimeException</span><span class="token punctuation">(</span><span class="token string">&quot;Error processing bank details&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">when</span><span class="token punctuation">(</span>bankDetailsBean<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">validateMemberAccount</span><span class="token punctuation">(</span>member<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// Act and Assert</span>
        <span class="token class-name">RuntimeException</span> runtimeException <span class="token operator">=</span> <span class="token function">assertThrows</span><span class="token punctuation">(</span><span class="token class-name">RuntimeException</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> bankDetailsBean<span class="token punctuation">.</span><span class="token function">validateMemberAccount</span><span class="token punctuation">(</span>member<span class="token punctuation">)</span><span class="token punctuation">,</span>
                <span class="token string">&quot;Exception should be thrown when processing bank details&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><blockquote><p>You can also verify the exption message thrown if its correct using <code>assertequals</code></p></blockquote> <ol start="2"><li>check on cases where it won't trow an exception</li></ol> <div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">// Act and Assert</span>
        <span class="token function">assertDoesNotThrow</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> bankDetailsBean<span class="token punctuation">.</span><span class="token function">validateMemberAccount</span><span class="token punctuation">(</span>member<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="_7-handling-numbers"><a href="#_7-handling-numbers" class="header-anchor">#</a> 7. Handling Numbers</h2> <ul><li>Use primitives for numbers or specify a delta for floating-point assertions.</li></ul> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">double</span> expectedValue <span class="token operator">=</span> <span class="token number">10.0</span><span class="token punctuation">;</span>
<span class="token keyword">double</span> actualValue <span class="token operator">=</span> <span class="token function">calculateSomeValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">double</span> delta <span class="token operator">=</span> <span class="token number">0.001</span><span class="token punctuation">;</span> <span class="token comment">// Specify a small delta for comparison</span>

<span class="token function">assertEquals</span><span class="token punctuation">(</span>expectedValue<span class="token punctuation">,</span> actualValue<span class="token punctuation">,</span> delta<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><blockquote><p>This is mostly applicable to bigdecimal values</p></blockquote> <h2 id="_8-mock-interfaces-not-classes"><a href="#_8-mock-interfaces-not-classes" class="header-anchor">#</a> 8. Mock Interfaces, Not Classes</h2> <ul><li>Mockito mocks interfaces by default for better flexibility.</li></ul> <h2 id="_9-mock-part-of-object"><a href="#_9-mock-part-of-object" class="header-anchor">#</a> 9. Mock Part of Object</h2> <p>Mocking part of an object and calling actual implementations involves creating a partial mock of an object, where certain methods are mocked while others are left to call the actual implementation.</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@Test</span>
<span class="token keyword">void</span> <span class="token function">createGeneralContribution</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
        <span class="token comment">// Test data</span>
        <span class="token class-name">Member</span> member <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Member</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        member<span class="token punctuation">.</span><span class="token function">setId</span><span class="token punctuation">(</span><span class="token number">1L</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">Batch</span> batch <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Batch</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        batch<span class="token punctuation">.</span><span class="token function">setId</span><span class="token punctuation">(</span><span class="token number">2L</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">Date</span> datePaid <span class="token operator">=</span> <span class="token class-name"><span class="token namespace">java<span class="token punctuation">.</span>sql<span class="token punctuation">.</span></span>Date</span><span class="token punctuation">.</span><span class="token function">valueOf</span><span class="token punctuation">(</span><span class="token class-name">LocalDate</span><span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// Create a general contribution without saving</span>
        <span class="token class-name">Contribution</span> contribution <span class="token operator">=</span> contributionBean<span class="token punctuation">.</span><span class="token function">createGeneralContribution</span><span class="token punctuation">(</span>
                <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">,</span> member<span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> member<span class="token punctuation">,</span> <span class="token number">2024</span><span class="token punctuation">,</span> <span class="token class-name"><span class="token namespace">com<span class="token punctuation">.</span>systech<span class="token punctuation">.</span>fm<span class="token punctuation">.</span>model<span class="token punctuation">.</span>members<span class="token punctuation">.</span></span>Month</span><span class="token punctuation">.</span><span class="token constant">JAN</span><span class="token punctuation">,</span> batch<span class="token punctuation">,</span> batch<span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                datePaid<span class="token punctuation">,</span> <span class="token class-name">ContributionType</span><span class="token punctuation">.</span><span class="token constant">NORMAL</span><span class="token punctuation">,</span> <span class="token class-name">ContributionStatus</span><span class="token punctuation">.</span><span class="token constant">REGISTERED</span><span class="token punctuation">,</span> <span class="token number">3L</span><span class="token punctuation">,</span> <span class="token class-name">SalaryType</span><span class="token punctuation">.</span><span class="token constant">GIVEN</span><span class="token punctuation">,</span>
                <span class="token keyword">new</span> <span class="token class-name">BigDecimal</span><span class="token punctuation">(</span><span class="token string">&quot;5000.00&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">BigDecimal</span><span class="token punctuation">(</span><span class="token string">&quot;5000.00&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">BigDecimal</span><span class="token punctuation">(</span><span class="token string">&quot;300.00&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                <span class="token keyword">new</span> <span class="token class-name">BigDecimal</span><span class="token punctuation">(</span><span class="token string">&quot;200.00&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">BigDecimal</span><span class="token punctuation">(</span><span class="token string">&quot;100.00&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">BigDecimal</span><span class="token punctuation">(</span><span class="token string">&quot;50.00&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                <span class="token keyword">new</span> <span class="token class-name">BigDecimal</span><span class="token punctuation">(</span><span class="token string">&quot;25.00&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">BigDecimal</span><span class="token punctuation">(</span><span class="token string">&quot;20.00&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">BigDecimal</span><span class="token punctuation">(</span><span class="token string">&quot;15.00&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                <span class="token keyword">new</span> <span class="token class-name">BigDecimal</span><span class="token punctuation">(</span><span class="token string">&quot;10.00&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">BigDecimal</span><span class="token punctuation">(</span><span class="token string">&quot;5.00&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">BigDecimal</span><span class="token punctuation">(</span><span class="token string">&quot;2.50&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                <span class="token keyword">new</span> <span class="token class-name">BigDecimal</span><span class="token punctuation">(</span><span class="token string">&quot;2.50&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">BigDecimal</span><span class="token punctuation">(</span><span class="token string">&quot;2.50&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">BigDecimal</span><span class="token punctuation">(</span><span class="token string">&quot;2.50&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// Validate the created contribution</span>
        <span class="token function">assertNotNull</span><span class="token punctuation">(</span>contribution<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">assertNull</span><span class="token punctuation">(</span>contribution<span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Since we didn't save it</span>

        <span class="token comment">// Create a general contribution and save it</span>
        contribution<span class="token punctuation">.</span><span class="token function">setId</span><span class="token punctuation">(</span><span class="token number">1L</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">when</span><span class="token punctuation">(</span>contributionDao<span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span><span class="token function">any</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">thenReturn</span><span class="token punctuation">(</span>contribution<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">Contribution</span> savedContribution <span class="token operator">=</span> contributionBean<span class="token punctuation">.</span><span class="token function">createGeneralContribution</span><span class="token punctuation">(</span>
                <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">,</span> member<span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> member<span class="token punctuation">,</span> <span class="token number">2024</span><span class="token punctuation">,</span> <span class="token class-name"><span class="token namespace">com<span class="token punctuation">.</span>systech<span class="token punctuation">.</span>fm<span class="token punctuation">.</span>model<span class="token punctuation">.</span>members<span class="token punctuation">.</span></span>Month</span><span class="token punctuation">.</span><span class="token constant">JAN</span><span class="token punctuation">,</span> batch<span class="token punctuation">,</span> batch<span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                datePaid<span class="token punctuation">,</span> <span class="token class-name">ContributionType</span><span class="token punctuation">.</span><span class="token constant">NORMAL</span><span class="token punctuation">,</span> <span class="token class-name">ContributionStatus</span><span class="token punctuation">.</span><span class="token constant">REGISTERED</span><span class="token punctuation">,</span> <span class="token number">3L</span><span class="token punctuation">,</span> <span class="token class-name">SalaryType</span><span class="token punctuation">.</span><span class="token constant">GIVEN</span><span class="token punctuation">,</span>
                <span class="token keyword">new</span> <span class="token class-name">BigDecimal</span><span class="token punctuation">(</span><span class="token string">&quot;5000.00&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">BigDecimal</span><span class="token punctuation">(</span><span class="token string">&quot;5000.00&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">BigDecimal</span><span class="token punctuation">(</span><span class="token string">&quot;300.00&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                <span class="token keyword">new</span> <span class="token class-name">BigDecimal</span><span class="token punctuation">(</span><span class="token string">&quot;200.00&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">BigDecimal</span><span class="token punctuation">(</span><span class="token string">&quot;100.00&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">BigDecimal</span><span class="token punctuation">(</span><span class="token string">&quot;50.00&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                <span class="token keyword">new</span> <span class="token class-name">BigDecimal</span><span class="token punctuation">(</span><span class="token string">&quot;25.00&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">BigDecimal</span><span class="token punctuation">(</span><span class="token string">&quot;20.00&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">BigDecimal</span><span class="token punctuation">(</span><span class="token string">&quot;15.00&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                <span class="token keyword">new</span> <span class="token class-name">BigDecimal</span><span class="token punctuation">(</span><span class="token string">&quot;10.00&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">BigDecimal</span><span class="token punctuation">(</span><span class="token string">&quot;5.00&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">BigDecimal</span><span class="token punctuation">(</span><span class="token string">&quot;2.50&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                <span class="token keyword">new</span> <span class="token class-name">BigDecimal</span><span class="token punctuation">(</span><span class="token string">&quot;2.50&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">BigDecimal</span><span class="token punctuation">(</span><span class="token string">&quot;2.50&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">BigDecimal</span><span class="token punctuation">(</span><span class="token string">&quot;2.50&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// Validate the saved contribution</span>
        <span class="token function">assertNotNull</span><span class="token punctuation">(</span>savedContribution<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">assertNotNull</span><span class="token punctuation">(</span>savedContribution<span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">assertEquals</span><span class="token punctuation">(</span>member<span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> savedContribution<span class="token punctuation">.</span><span class="token function">getMemberId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">assertEquals</span><span class="token punctuation">(</span>batch<span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> savedContribution<span class="token punctuation">.</span><span class="token function">getBatchId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">assertEquals</span><span class="token punctuation">(</span><span class="token number">2024</span><span class="token punctuation">,</span> savedContribution<span class="token punctuation">.</span><span class="token function">getYear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">assertEquals</span><span class="token punctuation">(</span><span class="token class-name">Month</span><span class="token punctuation">.</span><span class="token constant">JAN</span><span class="token punctuation">.</span><span class="token function">name</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> savedContribution<span class="token punctuation">.</span><span class="token function">getMonth</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">name</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">assertEquals</span><span class="token punctuation">(</span>datePaid<span class="token punctuation">,</span> savedContribution<span class="token punctuation">.</span><span class="token function">getDatePaid</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">assertEquals</span><span class="token punctuation">(</span><span class="token class-name">ContributionType</span><span class="token punctuation">.</span><span class="token constant">NORMAL</span><span class="token punctuation">,</span> savedContribution<span class="token punctuation">.</span><span class="token function">getType</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">assertEquals</span><span class="token punctuation">(</span><span class="token class-name">ContributionStatus</span><span class="token punctuation">.</span><span class="token constant">REGISTERED</span><span class="token punctuation">,</span> savedContribution<span class="token punctuation">.</span><span class="token function">getStatus</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">assertEquals</span><span class="token punctuation">(</span><span class="token number">3L</span><span class="token punctuation">,</span> savedContribution<span class="token punctuation">.</span><span class="token function">getApId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">assertEquals</span><span class="token punctuation">(</span><span class="token class-name">SalaryType</span><span class="token punctuation">.</span><span class="token constant">GIVEN</span><span class="token punctuation">,</span> savedContribution<span class="token punctuation">.</span><span class="token function">getSalaryType</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">assertEquals</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">BigDecimal</span><span class="token punctuation">(</span><span class="token string">&quot;5000.00&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> savedContribution<span class="token punctuation">.</span><span class="token function">getSalary</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">assertEquals</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">BigDecimal</span><span class="token punctuation">(</span><span class="token string">&quot;5000.00&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> savedContribution<span class="token punctuation">.</span><span class="token function">getBasicSalary</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">assertEquals</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">BigDecimal</span><span class="token punctuation">(</span><span class="token string">&quot;300.00&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> savedContribution<span class="token punctuation">.</span><span class="token function">getEe</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">assertEquals</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">BigDecimal</span><span class="token punctuation">(</span><span class="token string">&quot;200.00&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> savedContribution<span class="token punctuation">.</span><span class="token function">getEr</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">assertEquals</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">BigDecimal</span><span class="token punctuation">(</span><span class="token string">&quot;100.00&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> savedContribution<span class="token punctuation">.</span><span class="token function">getAvc</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">assertEquals</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">BigDecimal</span><span class="token punctuation">(</span><span class="token string">&quot;50.00&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> savedContribution<span class="token punctuation">.</span><span class="token function">getAvcer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">assertEquals</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">BigDecimal</span><span class="token punctuation">(</span><span class="token string">&quot;25.00&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> savedContribution<span class="token punctuation">.</span><span class="token function">getSupplementary</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">assertEquals</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">BigDecimal</span><span class="token punctuation">(</span><span class="token string">&quot;20.00&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> savedContribution<span class="token punctuation">.</span><span class="token function">getBrokerFee</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">assertEquals</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">BigDecimal</span><span class="token punctuation">(</span><span class="token string">&quot;15.00&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> savedContribution<span class="token punctuation">.</span><span class="token function">getAdminFee</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">assertEquals</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">BigDecimal</span><span class="token punctuation">(</span><span class="token string">&quot;10.00&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> savedContribution<span class="token punctuation">.</span><span class="token function">getGroupAssurance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">assertEquals</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">BigDecimal</span><span class="token punctuation">(</span><span class="token string">&quot;5.00&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> savedContribution<span class="token punctuation">.</span><span class="token function">getGeneralReserve</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">assertEquals</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">BigDecimal</span><span class="token punctuation">(</span><span class="token string">&quot;2.50&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> savedContribution<span class="token punctuation">.</span><span class="token function">getIncomeProtectionPlan</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">assertEquals</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">BigDecimal</span><span class="token punctuation">(</span><span class="token string">&quot;7.50&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> savedContribution<span class="token punctuation">.</span><span class="token function">getNssf</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre></div><blockquote><p><code>createGeneralContribution()</code> tests the <code>ContributionBean</code> class's <code>createGeneralContribution()</code> method. It creates a general contribution object, both with and without saving it to the database, and validates the behavior.</p> <p><code>ContributionDao</code> is mocked to return a specific Contribution object when the <code>save()</code> method is called. However, the actual implementation of the <code>save()</code> method is allowed to execute, which means the contribution object is persisted to the database.</p></blockquote> <blockquote><p>Mocking part of an object and calling actual implementations is useful when you want to retain the original behavior of certain methods while mocking others for testing purposes. This approach allows for more flexible and focused unit tests by controlling specific interactions with dependencies.</p></blockquote> <p>Another example</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">test_generatePenBenNumber_memberNumberFormatWithZeroMemberNumber</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token comment">//Create an object to get actual method return</span>
        <span class="token class-name">BenefitBean</span> benefitBean <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BenefitBean</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        benefitBean<span class="token punctuation">.</span><span class="token function">setPensionerBean</span><span class="token punctuation">(</span>pensionerBean<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// Arrange</span>
        <span class="token class-name">Benefit</span> ben <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Benefit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Scheme</span> scheme <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Scheme</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Pensioner</span><span class="token punctuation">&gt;</span></span> bens <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">SetupParams</span> setupParams <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SetupParams</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Beneficiary</span> b <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Beneficiary</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        b<span class="token punctuation">.</span><span class="token function">setMember</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Member</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        ben<span class="token punctuation">.</span><span class="token function">setDateOfCalculation</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// scheme.setSchemeId(1L);</span>
        b<span class="token punctuation">.</span><span class="token function">getMember</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setMemberNo</span><span class="token punctuation">(</span><span class="token number">0L</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        setupParams<span class="token punctuation">.</span><span class="token function">setPensionNumberFormat</span><span class="token punctuation">(</span><span class="token class-name">PensionNumberFormat</span><span class="token punctuation">.</span><span class="token constant">MEMBER_NUMBER</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// Act</span>
        <span class="token function">when</span><span class="token punctuation">(</span>pensionerBean<span class="token punctuation">.</span><span class="token function">pensionersThisMonth</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">DateTime</span><span class="token punctuation">(</span>ben<span class="token punctuation">.</span><span class="token function">getDateOfCalculation</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toDate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>scheme<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">thenReturn</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">when</span><span class="token punctuation">(</span>pensionerBean<span class="token punctuation">.</span><span class="token function">getNextPenSeq</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">DateTime</span><span class="token punctuation">(</span>ben<span class="token punctuation">.</span><span class="token function">getDateOfCalculation</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> scheme<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">thenReturn</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token class-name">String</span> result <span class="token operator">=</span> benefitBean<span class="token punctuation">.</span><span class="token function">generatePenBenNumber</span><span class="token punctuation">(</span>ben<span class="token punctuation">,</span> scheme<span class="token punctuation">,</span> bens<span class="token punctuation">,</span> setupParams<span class="token punctuation">,</span> b<span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token comment">// Assert</span>
            <span class="token function">assertEquals</span><span class="token punctuation">(</span><span class="token string">&quot;B0010000&quot;</span><span class="token punctuation">,</span> result<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token function">verify</span><span class="token punctuation">(</span>pensionerBean<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getNextPenSeq</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">DateTime</span><span class="token punctuation">(</span>ben<span class="token punctuation">.</span><span class="token function">getDateOfCalculation</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> scheme<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token function">fail</span><span class="token punctuation">(</span><span class="token string">&quot;Exception should not be thrown here: &quot;</span><span class="token operator">+</span>e<span class="token punctuation">.</span><span class="token function">getMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
</code></pre></div><blockquote><p>Mockito's <code>when()</code> method is used to specify the behavior of the mocked methods <code>(pensionersThisMonth() and getNextPenSeq())</code>. The try-catch block ensures that any unexpected exceptions thrown during the test execution are caught and handled appropriately. This approach allows for controlled testing of the <code>generatePenBenNumber()</code>method while maintaining the actual behavior.</p></blockquote> <h2 id="_10-handling-unexpected-exceptions"><a href="#_10-handling-unexpected-exceptions" class="header-anchor">#</a> 10. Handling Unexpected Exceptions</h2> <p>Use <code>fail</code> to handle unexpected exceptions in tests.</p> <p>Using <code>fail()</code> when an unexpected exception is thrown in a test is a way to explicitly mark the test as failed when an exception occurs that is not expected or handled within the test case.</p> <h2 id="_11-use-of-beforeeach-and-aftereach-on-repetitive-method-calls"><a href="#_11-use-of-beforeeach-and-aftereach-on-repetitive-method-calls" class="header-anchor">#</a> 11. Use of BeforeEach  and AfterEach on repetitive method calls</h2> <ul><li>Utilize <code>@BeforeEach</code> and <code>@AfterEach</code> methods for setup and teardown.</li> <li>Verify common method invocations and their frequencies using Mockito.</li></ul> <div class="language-java extra-class"><pre class="language-java"><code>
    <span class="token annotation punctuation">@BeforeEach</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setUp</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
        <span class="token class-name">MockitoAnnotations</span><span class="token punctuation">.</span><span class="token function">openMocks</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        contributionReversalBean <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ContributionReversalBean</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        contributionReversalBean<span class="token punctuation">.</span><span class="token function">setCommonStuffBean</span><span class="token punctuation">(</span>commonStuffBean<span class="token punctuation">)</span><span class="token punctuation">;</span>
        contributionReversalBean<span class="token punctuation">.</span><span class="token function">setAccountingPeriodBean</span><span class="token punctuation">(</span>accountingPeriodBean<span class="token punctuation">)</span><span class="token punctuation">;</span>
        contributionReversalBean<span class="token punctuation">.</span><span class="token function">setContributionBean</span><span class="token punctuation">(</span>contributionBean<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">AccountingPeriod</span> accountingPeriod <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">AccountingPeriod</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        accountingPeriod<span class="token punctuation">.</span><span class="token function">setId</span><span class="token punctuation">(</span><span class="token number">1L</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token function">when</span><span class="token punctuation">(</span>commonStuffBean<span class="token punctuation">.</span><span class="token function">sanitizeBigDecimal</span><span class="token punctuation">(</span><span class="token function">any</span><span class="token punctuation">(</span><span class="token class-name">BigDecimal</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">thenAnswer</span><span class="token punctuation">(</span>invocationOnMock <span class="token operator">-&gt;</span> invocationOnMock<span class="token punctuation">.</span><span class="token function">getArgument</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">when</span><span class="token punctuation">(</span>accountingPeriodDAO<span class="token punctuation">.</span><span class="token function">findByDatePeriodScheme</span><span class="token punctuation">(</span><span class="token function">any</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">any</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">any</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">thenReturn</span><span class="token punctuation">(</span>accountingPeriod<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">when</span><span class="token punctuation">(</span>accountingPeriodBean<span class="token punctuation">.</span><span class="token function">getPeriod</span><span class="token punctuation">(</span><span class="token function">any</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">any</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">any</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">thenReturn</span><span class="token punctuation">(</span>accountingPeriod<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">when</span><span class="token punctuation">(</span>contributionBean<span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span><span class="token function">any</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">thenAnswer</span><span class="token punctuation">(</span>invocationOnMock <span class="token operator">-&gt;</span> invocationOnMock<span class="token punctuation">.</span><span class="token function">getArgument</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@AfterEach</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">doFinish</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
        <span class="token comment">// Verify that commonStuffBean.sanitizeBigDecimal() was called with any BigDecimal argument</span>
        <span class="token function">verify</span><span class="token punctuation">(</span>commonStuffBean<span class="token punctuation">,</span> <span class="token function">times</span><span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">sanitizeBigDecimal</span><span class="token punctuation">(</span><span class="token function">any</span><span class="token punctuation">(</span><span class="token class-name">BigDecimal</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre></div><blockquote><p>This ensures that each test method executes in a consistent and isolated environment, leading to more reliable and maintainable test suites.</p></blockquote> <h2 id="_12-avoid-dependency-injection-in-test-classes"><a href="#_12-avoid-dependency-injection-in-test-classes" class="header-anchor">#</a> 12. Avoid Dependency Injection in Test Classes</h2> <ul><li>Avoid annotations like <code>@EJB</code> or <code>@Inject</code> in test classes for cleaner testing.</li></ul> <ol><li>Test classes should focus solely on testing the behavior of the unit under test rather than managing dependencies. Injecting dependencies using annotations like <code>@EJB</code> or <code>@Inject</code> can introduce unnecessary complexity and coupling in test classes.</li> <li>Using annotations like <code>@EJB</code> or <code>@Inject</code> may require setting up a container environment or a dependency injection framework for test execution. This adds overhead and makes tests dependent on the availability and configuration of such environments.</li> <li>Test classes should be isolated from external dependencies to ensure that failures are due to issues in the unit being tested rather than its dependencies. By avoiding annotations that inject dependencies, tests become more self-contained and easier to diagnose and debug.</li></ol> <h2 id="conclusion"><a href="#conclusion" class="header-anchor">#</a> Conclusion</h2> <p>Mastering these testing practices will lead to more robust and maintainable unit tests, ensuring the reliability and stability of your Java applications.</p></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">2/29/2024, 1:40:58 PM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/backups-guide/database-backups/databases.html" class="prev">
        Databases
      </a></span> <span class="next"><a href="/testing/integration-testing.html">
        Integration Testing
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.01d733ff.js" defer></script><script src="/assets/js/2.51e18b29.js" defer></script><script src="/assets/js/30.e924c7bc.js" defer></script>
  </body>
</html>
